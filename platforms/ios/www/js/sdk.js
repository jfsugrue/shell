/*!
 * @license
 * Atomic Web SDK 23.3.2
 * Copyright 2022 Atomic.io Limited.
 * For licenses of open source libraries used by the Atomic SDK, please
 * see https://downloads.atomic.io/web-sdk/release/23.3.2/LICENSES.txt.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AtomicSDK=t():e.AtomicSDK=t()}(globalThis,(function(){return(()=>{var e={4963:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},7722:(e,t,n)=>{var r=n(6314)("unscopables"),i=Array.prototype;null==i[r]&&n(7728)(i,r,{}),e.exports=function(e){i[r][e]=!0}},7007:(e,t,n)=>{var r=n(5286);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},9315:(e,t,n)=>{var r=n(2110),i=n(875),s=n(2337);e.exports=function(e){return function(t,n,a){var o,c=r(t),u=i(c.length),l=s(a,u);if(e&&n!=n){for(;u>l;)if((o=c[l++])!=o)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}}},2032:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},5645:e=>{var t=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=t)},741:(e,t,n)=>{var r=n(4963);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},1355:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},7057:(e,t,n)=>{e.exports=!n(4253)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},2457:(e,t,n)=>{var r=n(5286),i=n(3816).document,s=r(i)&&r(i.createElement);e.exports=function(e){return s?i.createElement(e):{}}},4430:e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},2985:(e,t,n)=>{var r=n(3816),i=n(5645),s=n(7728),a=n(3415),o=n(741),c=function(e,t,n){var u,l,d,h,f=e&c.F,v=e&c.G,m=e&c.S,p=e&c.P,g=e&c.B,b=v?r:m?r[t]||(r[t]={}):(r[t]||{}).prototype,y=v?i:i[t]||(i[t]={}),I=y.prototype||(y.prototype={});for(u in v&&(n=t),n)d=((l=!f&&b&&void 0!==b[u])?b:n)[u],h=g&&l?o(d,r):p&&"function"==typeof d?o(Function.call,d):d,b&&a(b,u,d,e&c.U),y[u]!=d&&s(y,u,h),p&&I[u]!=d&&(I[u]=d)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},4253:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},18:(e,t,n)=>{e.exports=n(3825)("native-function-to-string",Function.toString)},3816:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},9181:e=>{var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},7728:(e,t,n)=>{var r=n(9275),i=n(681);e.exports=n(7057)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},639:(e,t,n)=>{var r=n(3816).document;e.exports=r&&r.documentElement},1734:(e,t,n)=>{e.exports=!n(7057)&&!n(4253)((function(){return 7!=Object.defineProperty(n(2457)("div"),"a",{get:function(){return 7}}).a}))},9797:(e,t,n)=>{var r=n(2032);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},5286:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},9988:(e,t,n)=>{"use strict";var r=n(2503),i=n(681),s=n(2943),a={};n(7728)(a,n(6314)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),s(e,t+" Iterator")}},2923:(e,t,n)=>{"use strict";var r=n(4461),i=n(2985),s=n(3415),a=n(7728),o=n(7234),c=n(9988),u=n(2943),l=n(468),d=n(6314)("iterator"),h=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,v,m,p,g){c(n,t,v);var b,y,I,k=function(e){if(!h&&e in A)return A[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",w="values"==m,T=!1,A=e.prototype,C=A[d]||A["@@iterator"]||m&&A[m],E=C||k(m),D=m?w?k("entries"):E:void 0,x="Array"==t&&A.entries||C;if(x&&(I=l(x.call(new e)))!==Object.prototype&&I.next&&(u(I,S,!0),r||"function"==typeof I[d]||a(I,d,f)),w&&C&&"values"!==C.name&&(T=!0,E=function(){return C.call(this)}),r&&!g||!h&&!T&&A[d]||a(A,d,E),o[t]=E,o[S]=f,m)if(b={values:w?E:k("values"),keys:p?E:k("keys"),entries:D},g)for(y in b)y in A||s(A,y,b[y]);else i(i.P+i.F*(h||T),t,b);return b}},5436:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},7234:e=>{e.exports={}},4461:e=>{e.exports=!1},2503:(e,t,n)=>{var r=n(7007),i=n(5588),s=n(4430),a=n(9335)("IE_PROTO"),o=function(){},c=function(){var e,t=n(2457)("iframe"),r=s.length;for(t.style.display="none",n(639).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[s[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(o.prototype=r(e),n=new o,o.prototype=null,n[a]=e):n=c(),void 0===t?n:i(n,t)}},9275:(e,t,n)=>{var r=n(7007),i=n(1734),s=n(1689),a=Object.defineProperty;t.f=n(7057)?Object.defineProperty:function(e,t,n){if(r(e),t=s(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},5588:(e,t,n)=>{var r=n(9275),i=n(7007),s=n(7184);e.exports=n(7057)?Object.defineProperties:function(e,t){i(e);for(var n,a=s(t),o=a.length,c=0;o>c;)r.f(e,n=a[c++],t[n]);return e}},468:(e,t,n)=>{var r=n(9181),i=n(508),s=n(9335)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},189:(e,t,n)=>{var r=n(9181),i=n(2110),s=n(9315)(!1),a=n(9335)("IE_PROTO");e.exports=function(e,t){var n,o=i(e),c=0,u=[];for(n in o)n!=a&&r(o,n)&&u.push(n);for(;t.length>c;)r(o,n=t[c++])&&(~s(u,n)||u.push(n));return u}},7184:(e,t,n)=>{var r=n(189),i=n(4430);e.exports=Object.keys||function(e){return r(e,i)}},681:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},3415:(e,t,n)=>{var r=n(3816),i=n(7728),s=n(9181),a=n(3953)("src"),o=n(18),c=(""+o).split("toString");n(5645).inspectSource=function(e){return o.call(e)},(e.exports=function(e,t,n,o){var u="function"==typeof n;u&&(s(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(s(n,a)||i(n,a,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:o?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||o.call(this)}))},2943:(e,t,n)=>{var r=n(9275).f,i=n(9181),s=n(6314)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,s)&&r(e,s,{configurable:!0,value:t})}},9335:(e,t,n)=>{var r=n(3825)("keys"),i=n(3953);e.exports=function(e){return r[e]||(r[e]=i(e))}},3825:(e,t,n)=>{var r=n(5645),i=n(3816),s=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(4461)?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},2337:(e,t,n)=>{var r=n(1467),i=Math.max,s=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):s(e,t)}},1467:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},2110:(e,t,n)=>{var r=n(9797),i=n(1355);e.exports=function(e){return r(i(e))}},875:(e,t,n)=>{var r=n(1467),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},508:(e,t,n)=>{var r=n(1355);e.exports=function(e){return Object(r(e))}},1689:(e,t,n)=>{var r=n(5286);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},3953:e=>{var t=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+n).toString(36))}},6314:(e,t,n)=>{var r=n(3825)("wks"),i=n(3953),s=n(3816).Symbol,a="function"==typeof s;(e.exports=function(e){return r[e]||(r[e]=a&&s[e]||(a?s:i)("Symbol."+e))}).store=r},6997:(e,t,n)=>{"use strict";var r=n(7722),i=n(5436),s=n(7234),a=n(2110);e.exports=n(2923)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),s.Arguments=s.Array,r("keys"),r("values"),r("entries")},1181:(e,t,n)=>{for(var r=n(6997),i=n(7184),s=n(3415),a=n(3816),o=n(7728),c=n(7234),u=n(6314),l=u("iterator"),d=u("toStringTag"),h=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=i(f),m=0;m<v.length;m++){var p,g=v[m],b=f[g],y=a[g],I=y&&y.prototype;if(I&&(I[l]||o(I,l,h),I[d]||o(I,d,g),c[g]=h,b))for(p in r)I[p]||s(I,p,r[p],!0)}},4630:(e,t,n)=>{(e.exports=n(3645)(!1)).push([e.id,"/* Take care to only target specific ID base styles here to avoid style pollution in the host site */\niframe.atomic-sdk-frame.launcher {\n  width: 460px;\n  position: fixed;\n  bottom: 100px;\n  right: 0px;\n  top: 0px;\n  height: 100%;\n  max-width: 100%;\n  animation: atomic-sdk-launcher-close 0.1s ease forwards;\n}\n\niframe.atomic-sdk-frame.launcher.open {\n  animation: atomic-sdk-launcher-open 0.1s ease forwards;\n}\n\n@keyframes atomic-sdk-launcher-open {\n  0% {\n    opacity: 0;\n    transform: translateY(20px);\n    pointer-events: auto;\n  }\n  100% {\n    opacity: 1;\n    transform: translateY(0);\n    z-index: 2;\n  }\n}\n\n@keyframes atomic-sdk-launcher-close {\n  0% {\n    opacity: 1;\n    transform: translateY(0);\n    pointer-events: none;\n  }\n  100% {\n    opacity: 0;\n    transform: translateY(20px);\n    z-index: -2;\n  }\n}\n\n.atomic-sdk-launcher {\n  background-color: blue;\n  overflow: hidden;\n  height: 60px;\n  width: 60px;\n  border-radius: 999px;\n  box-shadow: 0 2px 20px 0 rgba(0, 0, 0, 0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0;\n  transform: scale(0.1);\n  animation: atomic-sdk-launcher 0.2s forwards;\n  transition: all 0.1s ease;\n  cursor: pointer;\n  border: 0;\n}\n\n@keyframes atomic-sdk-launcher {\n  from {\n    transform: scale(0.1);\n    opacity: 0;\n  }\n  to {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n.atomic-sdk-launcher-wrapper {\n  width: 60px;\n  height: 60px;\n  display: flex;\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n}\n\niframe.atomic-sdk-frame.standalone.shrink {\n  max-height: 2000px;\n  transition: max-height 1s ease-out 2.3s;\n}\n\n#atomic-sdk-toast-container {\n  position: fixed;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%);\n  max-width: 500px;\n  height: 0px;\n  z-index: 2;\n}",""])},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),s=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(s).concat([i]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var s=this[i][0];null!=s&&(r[s]=!0)}for(i=0;i<e.length;i++){var a=e[i];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},3561:e=>{e.exports=function(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();return t.setSeconds(0,0),6e4*n+t.getTime()%6e4}},4844:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setDate(n.getDate()+i),n}},2680:(e,t,n)=>{var r=n(2951),i=36e5;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},7538:(e,t,n)=>{var r=n(2385),i=n(1138);e.exports=function(e,t){var n=Number(t);return i(e,r(e)+n)}},2951:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},1318:(e,t,n)=>{var r=n(2951),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},9331:(e,t,n)=>{var r=n(1884),i=n(2807);e.exports=function(e,t){var n=r(e),s=Number(t),a=n.getMonth()+s,o=new Date(0);o.setFullYear(n.getFullYear(),a,1),o.setHours(0,0,0,0);var c=i(o);return n.setMonth(a,Math.min(c,n.getDate())),n}},1482:(e,t,n)=>{var r=n(9331);e.exports=function(e,t){var n=Number(t);return r(e,3*n)}},9723:(e,t,n)=>{var r=n(2951);e.exports=function(e,t){var n=Number(t);return r(e,1e3*n)}},5932:(e,t,n)=>{var r=n(4844);e.exports=function(e,t){var n=Number(t);return r(e,7*n)}},6083:(e,t,n)=>{var r=n(9331);e.exports=function(e,t){var n=Number(t);return r(e,12*n)}},6739:(e,t,n)=>{var r=n(1884);e.exports=function(e,t,n,i){var s=r(e).getTime(),a=r(t).getTime(),o=r(n).getTime(),c=r(i).getTime();if(s>a||o>c)throw new Error("The start of the range cannot be after the end of the range");return s<c&&o<a}},7886:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){if(!(t instanceof Array))throw new TypeError(toString.call(t)+" is not an instance of Array");var n,i,s=r(e).getTime();return t.forEach((function(e,t){var a=r(e),o=Math.abs(s-a.getTime());(void 0===n||o<i)&&(n=t,i=o)})),n}},3806:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){if(!(t instanceof Array))throw new TypeError(toString.call(t)+" is not an instance of Array");var n,i,s=r(e).getTime();return t.forEach((function(e){var t=r(e),a=Math.abs(s-t.getTime());(void 0===n||a<i)&&(n=t,i=a)})),n}},3374:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e).getTime(),i=r(t).getTime();return n<i?-1:n>i?1:0}},3558:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e).getTime(),i=r(t).getTime();return n>i?-1:n<i?1:0}},6656:(e,t,n)=>{var r=n(6579),i=6e4,s=864e5;e.exports=function(e,t){var n=r(e),a=r(t),o=n.getTime()-n.getTimezoneOffset()*i,c=a.getTime()-a.getTimezoneOffset()*i;return Math.round((o-c)/s)}},6554:(e,t,n)=>{var r=n(1971),i=6e4,s=6048e5;e.exports=function(e,t){var n=r(e),a=r(t),o=n.getTime()-n.getTimezoneOffset()*i,c=a.getTime()-a.getTimezoneOffset()*i;return Math.round((o-c)/s)}},7051:(e,t,n)=>{var r=n(2385);e.exports=function(e,t){return r(e)-r(t)}},1924:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}},9729:(e,t,n)=>{var r=n(21),i=n(1884);e.exports=function(e,t){var n=i(e),s=i(t);return 4*(n.getFullYear()-s.getFullYear())+(r(n)-r(s))}},9871:(e,t,n)=>{var r=n(5344),i=6e4,s=6048e5;e.exports=function(e,t,n){var a=r(e,n),o=r(t,n),c=a.getTime()-a.getTimezoneOffset()*i,u=o.getTime()-o.getTimezoneOffset()*i;return Math.round((c-u)/s)}},8509:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()-i.getFullYear()}},6056:(e,t,n)=>{var r=n(1884),i=n(6656),s=n(3374);e.exports=function(e,t){var n=r(e),a=r(t),o=s(n,a),c=Math.abs(i(n,a));return n.setDate(n.getDate()-o*c),o*(c-(s(n,a)===-o))}},298:(e,t,n)=>{var r=n(8081),i=36e5;e.exports=function(e,t){var n=r(e,t)/i;return n>0?Math.floor(n):Math.ceil(n)}},9973:(e,t,n)=>{var r=n(1884),i=n(7051),s=n(3374),a=n(9883);e.exports=function(e,t){var n=r(e),o=r(t),c=s(n,o),u=Math.abs(i(n,o));return n=a(n,c*u),c*(u-(s(n,o)===-c))}},8081:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()-i.getTime()}},604:(e,t,n)=>{var r=n(8081),i=6e4;e.exports=function(e,t){var n=r(e,t)/i;return n>0?Math.floor(n):Math.ceil(n)}},1387:(e,t,n)=>{var r=n(1884),i=n(1924),s=n(3374);e.exports=function(e,t){var n=r(e),a=r(t),o=s(n,a),c=Math.abs(i(n,a));return n.setMonth(n.getMonth()-o*c),o*(c-(s(n,a)===-o))}},9403:(e,t,n)=>{var r=n(1387);e.exports=function(e,t){var n=r(e,t)/3;return n>0?Math.floor(n):Math.ceil(n)}},7977:(e,t,n)=>{var r=n(8081);e.exports=function(e,t){var n=r(e,t)/1e3;return n>0?Math.floor(n):Math.ceil(n)}},4496:(e,t,n)=>{var r=n(6056);e.exports=function(e,t){var n=r(e,t)/7;return n>0?Math.floor(n):Math.ceil(n)}},760:(e,t,n)=>{var r=n(1884),i=n(8509),s=n(3374);e.exports=function(e,t){var n=r(e),a=r(t),o=s(n,a),c=Math.abs(i(n,a));return n.setFullYear(n.getFullYear()-o*c),o*(c-(s(n,a)===-o))}},3332:(e,t,n)=>{var r=n(3558),i=n(1884),s=n(7977),a=n(1387),o=n(7479),c=1440,u=2520,l=43200,d=86400;e.exports=function(e,t,n){var h=n||{},f=r(e,t),v=h.locale,m=o.distanceInWords.localize;v&&v.distanceInWords&&v.distanceInWords.localize&&(m=v.distanceInWords.localize);var p,g,b={addSuffix:Boolean(h.addSuffix),comparison:f};f>0?(p=i(e),g=i(t)):(p=i(t),g=i(e));var y,I=s(g,p),k=g.getTimezoneOffset()-p.getTimezoneOffset(),S=Math.round(I/60)-k;if(S<2)return h.includeSeconds?I<5?m("lessThanXSeconds",5,b):I<10?m("lessThanXSeconds",10,b):I<20?m("lessThanXSeconds",20,b):I<40?m("halfAMinute",null,b):m(I<60?"lessThanXMinutes":"xMinutes",1,b):0===S?m("lessThanXMinutes",1,b):m("xMinutes",S,b);if(S<45)return m("xMinutes",S,b);if(S<90)return m("aboutXHours",1,b);if(S<c)return m("aboutXHours",Math.round(S/60),b);if(S<u)return m("xDays",1,b);if(S<l)return m("xDays",Math.round(S/c),b);if(S<d)return m("aboutXMonths",y=Math.round(S/l),b);if((y=a(g,p))<12)return m("xMonths",Math.round(S/l),b);var w=y%12,T=Math.floor(y/12);return w<3?m("aboutXYears",T,b):w<9?m("overXYears",T,b):m("almostXYears",T+1,b)}},7666:(e,t,n)=>{var r=n(3558),i=n(1884),s=n(7977),a=n(7479),o=1440,c=43200,u=525600;e.exports=function(e,t,n){var l=n||{},d=r(e,t),h=l.locale,f=a.distanceInWords.localize;h&&h.distanceInWords&&h.distanceInWords.localize&&(f=h.distanceInWords.localize);var v,m,p,g={addSuffix:Boolean(l.addSuffix),comparison:d};d>0?(v=i(e),m=i(t)):(v=i(t),m=i(e));var b=Math[l.partialMethod?String(l.partialMethod):"floor"],y=s(m,v),I=m.getTimezoneOffset()-v.getTimezoneOffset(),k=b(y/60)-I;if("s"===(p=l.unit?String(l.unit):k<1?"s":k<60?"m":k<o?"h":k<c?"d":k<u?"M":"Y"))return f("xSeconds",y,g);if("m"===p)return f("xMinutes",k,g);if("h"===p)return f("xHours",b(k/60),g);if("d"===p)return f("xDays",b(k/o),g);if("M"===p)return f("xMonths",b(k/c),g);if("Y"===p)return f("xYears",b(k/u),g);throw new Error("Unknown unit: "+p)}},6272:(e,t,n)=>{var r=n(3332);e.exports=function(e,t){return r(Date.now(),e,t)}},5411:(e,t,n)=>{var r=n(1884);e.exports=function(e,t,n){var i=r(e),s=void 0!==n?n:1,a=r(t).getTime();if(i.getTime()>a)throw new Error("The first date cannot be after the second date");var o=[],c=i;for(c.setHours(0,0,0,0);c.getTime()<=a;)o.push(r(c)),c.setDate(c.getDate()+s);return o}},549:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setHours(23,59,59,999),t}},2653:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setMinutes(59,59,999),t}},6718:(e,t,n)=>{var r=n(1322);e.exports=function(e){return r(e,{weekStartsOn:1})}},5648:(e,t,n)=>{var r=n(2385),i=n(1971);e.exports=function(e){var t=r(e),n=new Date(0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);var s=i(n);return s.setMilliseconds(s.getMilliseconds()-1),s}},9877:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setSeconds(59,999),t}},9356:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}},5661:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3+3;return t.setMonth(i,0),t.setHours(23,59,59,999),t}},6415:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setMilliseconds(999),t}},4404:(e,t,n)=>{var r=n(549);e.exports=function(){return r(new Date)}},7410:e=>{e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r+1),i.setHours(23,59,59,999),i}},1322:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),s=i.getDay(),a=6+(s<n?-7:0)-(s-n);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}},782:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}},4106:e=>{e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r-1),i.setHours(23,59,59,999),i}},5616:(e,t,n)=>{var r=n(8612),i=n(6563),s=n(2385),a=n(1884),o=n(623),c=n(7479);var u={M:function(e){return e.getMonth()+1},MM:function(e){return h(e.getMonth()+1,2)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},D:function(e){return e.getDate()},DD:function(e){return h(e.getDate(),2)},DDD:function(e){return r(e)},DDDD:function(e){return h(r(e),3)},d:function(e){return e.getDay()},E:function(e){return e.getDay()||7},W:function(e){return i(e)},WW:function(e){return h(i(e),2)},YY:function(e){return h(e.getFullYear(),4).substr(2)},YYYY:function(e){return h(e.getFullYear(),4)},GG:function(e){return String(s(e)).substr(2)},GGGG:function(e){return s(e)},H:function(e){return e.getHours()},HH:function(e){return h(e.getHours(),2)},h:function(e){var t=e.getHours();return 0===t?12:t>12?t%12:t},hh:function(e){return h(u.h(e),2)},m:function(e){return e.getMinutes()},mm:function(e){return h(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return h(e.getSeconds(),2)},S:function(e){return Math.floor(e.getMilliseconds()/100)},SS:function(e){return h(Math.floor(e.getMilliseconds()/10),2)},SSS:function(e){return h(e.getMilliseconds(),3)},Z:function(e){return d(e.getTimezoneOffset(),":")},ZZ:function(e){return d(e.getTimezoneOffset())},X:function(e){return Math.floor(e.getTime()/1e3)},x:function(e){return e.getTime()}};function l(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|]$/g,""):e.replace(/\\/g,"")}function d(e,t){t=t||"";var n=e>0?"-":"+",r=Math.abs(e),i=r%60;return n+h(Math.floor(r/60),2)+t+h(i,2)}function h(e,t){for(var n=Math.abs(e).toString();n.length<t;)n="0"+n;return n}e.exports=function(e,t,n){var r=t?String(t):"YYYY-MM-DDTHH:mm:ss.SSSZ",i=(n||{}).locale,s=c.format.formatters,d=c.format.formattingTokensRegExp;i&&i.format&&i.format.formatters&&(s=i.format.formatters,i.format.formattingTokensRegExp&&(d=i.format.formattingTokensRegExp));var h=a(e);return o(h)?function(e,t,n){var r,i,s=e.match(n),a=s.length;for(r=0;r<a;r++)i=t[s[r]]||u[s[r]],s[r]=i||l(s[r]);return function(e){for(var t="",n=0;n<a;n++)s[n]instanceof Function?t+=s[n](e,u):t+=s[n];return t}}(r,s,d)(h):"Invalid Date"}},5540:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getDate()}},2476:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getDay()}},8612:(e,t,n)=>{var r=n(1884),i=n(9834),s=n(6656);e.exports=function(e){var t=r(e);return s(t,i(t))+1}},2807:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getFullYear(),i=t.getMonth(),s=new Date(0);return s.setFullYear(n,i+1,0),s.setHours(0,0,0,0),s.getDate()}},4789:(e,t,n)=>{var r=n(1164);e.exports=function(e){return r(e)?366:365}},7921:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getHours()}},6373:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e).getDay();return 0===t&&(t=7),t}},6563:(e,t,n)=>{var r=n(1884),i=n(1971),s=n(3892),a=6048e5;e.exports=function(e){var t=r(e),n=i(t).getTime()-s(t).getTime();return Math.round(n/a)+1}},7098:(e,t,n)=>{var r=n(3892),i=n(5932),s=6048e5;e.exports=function(e){var t=r(e),n=r(i(t,60)).valueOf()-t.valueOf();return Math.round(n/s)}},2385:(e,t,n)=>{var r=n(1884),i=n(1971);e.exports=function(e){var t=r(e),n=t.getFullYear(),s=new Date(0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);var a=i(s),o=new Date(0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);var c=i(o);return t.getTime()>=a.getTime()?n+1:t.getTime()>=c.getTime()?n:n-1}},8597:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getMilliseconds()}},3362:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getMinutes()}},3503:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getMonth()}},5541:(e,t,n)=>{var r=n(1884),i=864e5;e.exports=function(e,t,n,s){var a=r(e).getTime(),o=r(t).getTime(),c=r(n).getTime(),u=r(s).getTime();if(a>o||c>u)throw new Error("The start of the range cannot be after the end of the range");if(!(a<u&&c<o))return 0;var l=(u>o?o:u)-(c<a?a:c);return Math.ceil(l/i)}},21:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return Math.floor(t.getMonth()/3)+1}},8780:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getSeconds()}},2482:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getTime()}},8194:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getFullYear()}},7292:(e,t,n)=>{e.exports={addDays:n(4844),addHours:n(2680),addISOYears:n(7538),addMilliseconds:n(2951),addMinutes:n(1318),addMonths:n(9331),addQuarters:n(1482),addSeconds:n(9723),addWeeks:n(5932),addYears:n(6083),areRangesOverlapping:n(6739),closestIndexTo:n(7886),closestTo:n(3806),compareAsc:n(3374),compareDesc:n(3558),differenceInCalendarDays:n(6656),differenceInCalendarISOWeeks:n(6554),differenceInCalendarISOYears:n(7051),differenceInCalendarMonths:n(1924),differenceInCalendarQuarters:n(9729),differenceInCalendarWeeks:n(9871),differenceInCalendarYears:n(8509),differenceInDays:n(6056),differenceInHours:n(298),differenceInISOYears:n(9973),differenceInMilliseconds:n(8081),differenceInMinutes:n(604),differenceInMonths:n(1387),differenceInQuarters:n(9403),differenceInSeconds:n(7977),differenceInWeeks:n(4496),differenceInYears:n(760),distanceInWords:n(3332),distanceInWordsStrict:n(7666),distanceInWordsToNow:n(6272),eachDay:n(5411),endOfDay:n(549),endOfHour:n(2653),endOfISOWeek:n(6718),endOfISOYear:n(5648),endOfMinute:n(9877),endOfMonth:n(9356),endOfQuarter:n(5661),endOfSecond:n(6415),endOfToday:n(4404),endOfTomorrow:n(7410),endOfWeek:n(1322),endOfYear:n(782),endOfYesterday:n(4106),format:n(5616),getDate:n(5540),getDay:n(2476),getDayOfYear:n(8612),getDaysInMonth:n(2807),getDaysInYear:n(4789),getHours:n(7921),getISODay:n(6373),getISOWeek:n(6563),getISOWeeksInYear:n(7098),getISOYear:n(2385),getMilliseconds:n(8597),getMinutes:n(3362),getMonth:n(3503),getOverlappingDaysInRanges:n(5541),getQuarter:n(21),getSeconds:n(8780),getTime:n(2482),getYear:n(8194),isAfter:n(2849),isBefore:n(7754),isDate:n(4286),isEqual:n(9601),isFirstDayOfMonth:n(1364),isFriday:n(2350),isFuture:n(9593),isLastDayOfMonth:n(4399),isLeapYear:n(1164),isMonday:n(126),isPast:n(798),isSameDay:n(4801),isSameHour:n(3344),isSameISOWeek:n(8029),isSameISOYear:n(7877),isSameMinute:n(4465),isSameMonth:n(248),isSameQuarter:n(5347),isSameSecond:n(1742),isSameWeek:n(4868),isSameYear:n(2130),isSaturday:n(2687),isSunday:n(2978),isThisHour:n(1587),isThisISOWeek:n(657),isThisISOYear:n(6106),isThisMinute:n(7980),isThisMonth:n(2767),isThisQuarter:n(1687),isThisSecond:n(7391),isThisWeek:n(147),isThisYear:n(576),isThursday:n(7999),isToday:n(5886),isTomorrow:n(7962),isTuesday:n(6330),isValid:n(623),isWednesday:n(5999),isWeekend:n(7455),isWithinRange:n(6254),isYesterday:n(9099),lastDayOfISOWeek:n(1944),lastDayOfISOYear:n(9312),lastDayOfMonth:n(4949),lastDayOfQuarter:n(3146),lastDayOfWeek:n(106),lastDayOfYear:n(2674),max:n(1489),min:n(3185),parse:n(1884),setDate:n(6130),setDay:n(1110),setDayOfYear:n(1418),setHours:n(6574),setISODay:n(8212),setISOWeek:n(570),setISOYear:n(1138),setMilliseconds:n(3934),setMinutes:n(4809),setMonth:n(6059),setQuarter:n(4059),setSeconds:n(1670),setYear:n(3821),startOfDay:n(6579),startOfHour:n(555),startOfISOWeek:n(1971),startOfISOYear:n(3892),startOfMinute:n(5580),startOfMonth:n(5130),startOfQuarter:n(9309),startOfSecond:n(9966),startOfToday:n(9978),startOfTomorrow:n(7743),startOfWeek:n(5344),startOfYear:n(9834),startOfYesterday:n(6441),subDays:n(5627),subHours:n(7413),subISOYears:n(9883),subMilliseconds:n(8502),subMinutes:n(3350),subMonths:n(1141),subQuarters:n(6607),subSeconds:n(9256),subWeeks:n(9862),subYears:n(8524)}},2849:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()>i.getTime()}},7754:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()<i.getTime()}},4286:e=>{e.exports=function(e){return e instanceof Date}},9601:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},1364:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 1===r(e).getDate()}},2350:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 5===r(e).getDay()}},9593:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getTime()>(new Date).getTime()}},4399:(e,t,n)=>{var r=n(1884),i=n(549),s=n(9356);e.exports=function(e){var t=r(e);return i(t).getTime()===s(t).getTime()}},1164:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e).getFullYear();return t%400==0||t%4==0&&t%100!=0}},126:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 1===r(e).getDay()}},798:(e,t,n)=>{var r=n(1884);e.exports=function(e){return r(e).getTime()<(new Date).getTime()}},4801:(e,t,n)=>{var r=n(6579);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},3344:(e,t,n)=>{var r=n(555);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},8029:(e,t,n)=>{var r=n(4868);e.exports=function(e,t){return r(e,t,{weekStartsOn:1})}},7877:(e,t,n)=>{var r=n(3892);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},4465:(e,t,n)=>{var r=n(5580);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},248:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}},5347:(e,t,n)=>{var r=n(9309);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},1742:(e,t,n)=>{var r=n(9966);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},4868:(e,t,n)=>{var r=n(5344);e.exports=function(e,t,n){var i=r(e,n),s=r(t,n);return i.getTime()===s.getTime()}},2130:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()===i.getFullYear()}},2687:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 6===r(e).getDay()}},2978:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 0===r(e).getDay()}},1587:(e,t,n)=>{var r=n(3344);e.exports=function(e){return r(new Date,e)}},657:(e,t,n)=>{var r=n(8029);e.exports=function(e){return r(new Date,e)}},6106:(e,t,n)=>{var r=n(7877);e.exports=function(e){return r(new Date,e)}},7980:(e,t,n)=>{var r=n(4465);e.exports=function(e){return r(new Date,e)}},2767:(e,t,n)=>{var r=n(248);e.exports=function(e){return r(new Date,e)}},1687:(e,t,n)=>{var r=n(5347);e.exports=function(e){return r(new Date,e)}},7391:(e,t,n)=>{var r=n(1742);e.exports=function(e){return r(new Date,e)}},147:(e,t,n)=>{var r=n(4868);e.exports=function(e,t){return r(new Date,e,t)}},576:(e,t,n)=>{var r=n(2130);e.exports=function(e){return r(new Date,e)}},7999:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 4===r(e).getDay()}},5886:(e,t,n)=>{var r=n(6579);e.exports=function(e){return r(e).getTime()===r(new Date).getTime()}},7962:(e,t,n)=>{var r=n(6579);e.exports=function(e){var t=new Date;return t.setDate(t.getDate()+1),r(e).getTime()===r(t).getTime()}},6330:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 2===r(e).getDay()}},623:(e,t,n)=>{var r=n(4286);e.exports=function(e){if(r(e))return!isNaN(e);throw new TypeError(toString.call(e)+" is not an instance of Date")}},5999:(e,t,n)=>{var r=n(1884);e.exports=function(e){return 3===r(e).getDay()}},7455:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e).getDay();return 0===t||6===t}},6254:(e,t,n)=>{var r=n(1884);e.exports=function(e,t,n){var i=r(e).getTime(),s=r(t).getTime(),a=r(n).getTime();if(s>a)throw new Error("The start of the range cannot be after the end of the range");return i>=s&&i<=a}},9099:(e,t,n)=>{var r=n(6579);e.exports=function(e){var t=new Date;return t.setDate(t.getDate()-1),r(e).getTime()===r(t).getTime()}},1944:(e,t,n)=>{var r=n(106);e.exports=function(e){return r(e,{weekStartsOn:1})}},9312:(e,t,n)=>{var r=n(2385),i=n(1971);e.exports=function(e){var t=r(e),n=new Date(0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);var s=i(n);return s.setDate(s.getDate()-1),s}},4949:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}},3146:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3+3;return t.setMonth(i,0),t.setHours(0,0,0,0),t}},106:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),s=i.getDay(),a=6+(s<n?-7:0)-(s-n);return i.setHours(0,0,0,0),i.setDate(i.getDate()+a),i}},2674:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(0,0,0,0),t}},8854:e=>{var t=["M","MM","Q","D","DD","DDD","DDDD","d","E","W","WW","YY","YYYY","GG","GGGG","H","HH","h","hh","m","mm","s","ss","S","SS","SSS","Z","ZZ","X","x"];e.exports=function(e){var n=[];for(var r in e)e.hasOwnProperty(r)&&n.push(r);var i=t.concat(n).sort().reverse();return new RegExp("(\\[[^\\[]*\\])|(\\\\)?("+i.join("|")+"|.)","g")}},2894:e=>{e.exports=function(){var e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};return{localize:function(t,n,r){var i;return r=r||{},i="string"==typeof e[t]?e[t]:1===n?e[t].one:e[t].other.replace("{{count}}",n),r.addSuffix?r.comparison>0?"in "+i:i+" ago":i}}}},664:(e,t,n)=>{var r=n(8854);e.exports=function(){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Su","Mo","Tu","We","Th","Fr","Sa"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["AM","PM"],o=["am","pm"],c=["a.m.","p.m."],u={MMM:function(t){return e[t.getMonth()]},MMMM:function(e){return t[e.getMonth()]},dd:function(e){return n[e.getDay()]},ddd:function(e){return i[e.getDay()]},dddd:function(e){return s[e.getDay()]},A:function(e){return e.getHours()/12>=1?a[1]:a[0]},a:function(e){return e.getHours()/12>=1?o[1]:o[0]},aa:function(e){return e.getHours()/12>=1?c[1]:c[0]}};return["M","D","DDD","d","Q","W"].forEach((function(e){u[e+"o"]=function(t,n){return function(e){var t=e%100;if(t>20||t<10)switch(t%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"}(n[e](t))}})),{formatters:u,formattingTokensRegExp:r(u)}}},7479:(e,t,n)=>{var r=n(2894),i=n(664);e.exports={distanceInWords:r(),format:i()}},1489:(e,t,n)=>{var r=n(1884);e.exports=function(){var e=Array.prototype.slice.call(arguments).map((function(e){return r(e)})),t=Math.max.apply(null,e);return new Date(t)}},3185:(e,t,n)=>{var r=n(1884);e.exports=function(){var e=Array.prototype.slice.call(arguments).map((function(e){return r(e)})),t=Math.min.apply(null,e);return new Date(t)}},1884:(e,t,n)=>{var r=n(3561),i=n(4286),s=36e5,a=6e4,o=2,c=/[T ]/,u=/:/,l=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],h=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],v=/^-(\d{2})$/,m=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,g=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,y=/^(\d{2}([.,]\d*)?)$/,I=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,k=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,w=/^(Z)$/,T=/^([+-])(\d{2})$/,A=/^([+-])(\d{2}):?(\d{2})$/;function C(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(i(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var E=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=S.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),D=function(e,t){var n,r=d[t],i=f[t];if(n=h.exec(e)||i.exec(e)){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=l.exec(e)||r.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(E.date,n),x=D.year,O=function(e,t){if(null===t)return null;var n,r,i,s;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=v.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=m.exec(e)){r=new Date(0);var a=parseInt(n[1],10);return r.setUTCFullYear(t,0,a),r}if(n=p.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return r.setUTCFullYear(t,i,o),r}if(n=g.exec(e))return s=parseInt(n[1],10)-1,C(t,s);if(n=b.exec(e)){s=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return C(t,s,c)}return null}(D.restDateString,x);if(O){var M,N=O.getTime(),R=0;if(E.time&&(R=function(e){var t,n,r;if(t=y.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*s;if(t=I.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*s+r*a;if(t=k.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*s+r*a+1e3*i}return null}(E.time)),E.timezone)M=function(e){var t,n;if(t=w.exec(e))return 0;if(t=T.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=A.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(E.timezone)*a;else{var P=N+R,F=new Date(P);M=r(F);var L=new Date(P);L.setDate(F.getDate()+1);var Y=r(L)-r(F);Y>0&&(M+=Y)}return new Date(N+R+M)}return new Date(e)}},6130:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setDate(i),n}},1110:(e,t,n)=>{var r=n(1884),i=n(4844);e.exports=function(e,t,n){var s=n&&Number(n.weekStartsOn)||0,a=r(e),o=Number(t),c=a.getDay();return i(a,((o%7+7)%7<s?7:0)+o-c)}},1418:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMonth(0),n.setDate(i),n}},6574:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setHours(i),n}},8212:(e,t,n)=>{var r=n(1884),i=n(4844),s=n(6373);e.exports=function(e,t){var n=r(e),a=Number(t),o=s(n);return i(n,a-o)}},570:(e,t,n)=>{var r=n(1884),i=n(6563);e.exports=function(e,t){var n=r(e),s=Number(t),a=i(n)-s;return n.setDate(n.getDate()-7*a),n}},1138:(e,t,n)=>{var r=n(1884),i=n(3892),s=n(6656);e.exports=function(e,t){var n=r(e),a=Number(t),o=s(n,i(n)),c=new Date(0);return c.setFullYear(a,0,4),c.setHours(0,0,0,0),(n=i(c)).setDate(n.getDate()+o),n}},3934:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMilliseconds(i),n}},4809:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMinutes(i),n}},6059:(e,t,n)=>{var r=n(1884),i=n(2807);e.exports=function(e,t){var n=r(e),s=Number(t),a=n.getFullYear(),o=n.getDate(),c=new Date(0);c.setFullYear(a,s,15),c.setHours(0,0,0,0);var u=i(c);return n.setMonth(s,Math.min(o,u)),n}},4059:(e,t,n)=>{var r=n(1884),i=n(6059);e.exports=function(e,t){var n=r(e),s=Number(t)-(Math.floor(n.getMonth()/3)+1);return i(n,n.getMonth()+3*s)}},1670:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setSeconds(i),n}},3821:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setFullYear(i),n}},6579:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setHours(0,0,0,0),t}},555:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setMinutes(0,0,0),t}},1971:(e,t,n)=>{var r=n(5344);e.exports=function(e){return r(e,{weekStartsOn:1})}},3892:(e,t,n)=>{var r=n(2385),i=n(1971);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),i(n)}},5580:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setSeconds(0,0),t}},5130:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setDate(1),t.setHours(0,0,0,0),t}},9309:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}},9966:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e);return t.setMilliseconds(0),t}},9978:(e,t,n)=>{var r=n(6579);e.exports=function(){return r(new Date)}},7743:e=>{e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r+1),i.setHours(0,0,0,0),i}},5344:(e,t,n)=>{var r=n(1884);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}},9834:(e,t,n)=>{var r=n(1884);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}},6441:e=>{e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r-1),i.setHours(0,0,0,0),i}},5627:(e,t,n)=>{var r=n(4844);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},7413:(e,t,n)=>{var r=n(2680);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},9883:(e,t,n)=>{var r=n(7538);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},8502:(e,t,n)=>{var r=n(2951);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},3350:(e,t,n)=>{var r=n(1318);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},1141:(e,t,n)=>{var r=n(9331);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},6607:(e,t,n)=>{var r=n(1482);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},9256:(e,t,n)=>{var r=n(9723);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},9862:(e,t,n)=>{var r=n(5932);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},8524:(e,t,n)=>{var r=n(6083);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},4042:(e,t,n)=>{var r;!function(i){
    /**
     * This script gives you the zone info key representing your device's time zone setting.
     *
     * @name jsTimezoneDetect
     * @version 1.0.6
     * @author Jon Nylander
     * @license MIT License - https://bitbucket.org/pellepim/jstimezonedetect/src/default/LICENCE.txt
     *
     * For usage and examples, visit:
     * http://pellepim.bitbucket.org/jstz/
     *
     * Copyright (c) Jon Nylander
     */
    var s=function(){"use strict";var e={DAY:864e5,HOUR:36e5,MINUTE:6e4,SECOND:1e3,BASELINE_YEAR:2014,MAX_SCORE:864e6,AMBIGUITIES:{"America/Denver":["America/Mazatlan"],"Europe/London":["Africa/Casablanca"],"America/Chicago":["America/Mexico_City"],"America/Asuncion":["America/Campo_Grande","America/Santiago"],"America/Montevideo":["America/Sao_Paulo","America/Santiago"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Europe/Helsinki","Asia/Damascus","Africa/Cairo","Asia/Gaza","Europe/Minsk"],"Pacific/Auckland":["Pacific/Fiji"],"America/Los_Angeles":["America/Santa_Isabel"],"America/New_York":["America/Havana"],"America/Halifax":["America/Goose_Bay"],"America/Godthab":["America/Miquelon"],"Asia/Dubai":["Asia/Yerevan"],"Asia/Jakarta":["Asia/Krasnoyarsk"],"Asia/Shanghai":["Asia/Irkutsk","Australia/Perth"],"Australia/Sydney":["Australia/Lord_Howe"],"Asia/Tokyo":["Asia/Yakutsk"],"Asia/Dhaka":["Asia/Omsk"],"Asia/Baku":["Asia/Yerevan"],"Australia/Brisbane":["Asia/Vladivostok"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Majuro":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk","Europe/Moscow"],"Asia/Karachi":["Asia/Yekaterinburg"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]}},t=function(e){var t=-e.getTimezoneOffset();return null!==t?t:0},n=function(){var n=t(new Date(e.BASELINE_YEAR,0,2)),r=t(new Date(e.BASELINE_YEAR,5,2)),i=n-r;return i<0?n+",1":i>0?r+",1,s":n+",0"},r=function(e){for(var t=new Date(e,0,1,0,0,1,0).getTime(),n=new Date(e,12,31,23,59,59).getTime(),r=t,s=new Date(r).getTimezoneOffset(),a=null,o=null;r<n-864e5;){var c=new Date(r),u=c.getTimezoneOffset();u!==s&&(u<s&&(a=c),u>s&&(o=c),s=u),r+=864e5}return!(!a||!o)&&{s:i(a).getTime(),e:i(o).getTime()}},i=function t(n,r,i){void 0===r&&(r=e.DAY,i=e.HOUR);for(var s=new Date(n.getTime()-r).getTime(),a=n.getTime()+r,o=new Date(s).getTimezoneOffset(),c=s,u=null;c<a-i;){var l=new Date(c);if(l.getTimezoneOffset()!==o){u=l;break}c+=i}return r===e.DAY?t(u,e.HOUR,e.MINUTE):r===e.HOUR?t(u,e.MINUTE,e.SECOND):u},a=function(t){var n=function(){for(var e=[],t=0;t<s.olson.dst_rules.years.length;t++){var n=r(s.olson.dst_rules.years[t]);e.push(n)}return e}();return function(e){for(var t=0;t<e.length;t++)if(!1!==e[t])return!0;return!1}(n)?function(t,n){for(var r=function(r){for(var i=0,s=0;s<t.length;s++)if(r.rules[s]&&t[s]){if(!(t[s].s>=r.rules[s].s&&t[s].e<=r.rules[s].e)){i="N/A";break}if(i=0,i+=Math.abs(t[s].s-r.rules[s].s),(i+=Math.abs(r.rules[s].e-t[s].e))>e.MAX_SCORE){i="N/A";break}}return i=function(e,t,n,r){if("N/A"!==n)return n;if("Asia/Beirut"===t){if("Africa/Cairo"===r.name&&13983768e5===e[6].s&&14116788e5===e[6].e)return 0;if("Asia/Jerusalem"===r.name&&13959648e5===e[6].s&&14118588e5===e[6].e)return 0}else if("America/Santiago"===t){if("America/Asuncion"===r.name&&14124816e5===e[6].s&&1397358e6===e[6].e)return 0;if("America/Campo_Grande"===r.name&&14136912e5===e[6].s&&13925196e5===e[6].e)return 0}else if("America/Montevideo"===t){if("America/Sao_Paulo"===r.name&&14136876e5===e[6].s&&1392516e6===e[6].e)return 0}else if("Pacific/Auckland"===t&&"Pacific/Fiji"===r.name&&14142456e5===e[6].s&&13961016e5===e[6].e)return 0;return n}(t,n,i,r)},i={},a=s.olson.dst_rules.zones,o=a.length,c=e.AMBIGUITIES[n],u=0;u<o;u++){var l=a[u],d=r(a[u]);"N/A"!==d&&(i[l.name]=d)}for(var h in i)if(i.hasOwnProperty(h))for(var f=0;f<c.length;f++)if(c[f]===h)return h;return n}(n,t):t};return{determine:function(){var r=function(){var e,t;if("undefined"!=typeof Intl&&void 0!==Intl.DateTimeFormat&&void 0!==(e=Intl.DateTimeFormat())&&void 0!==e.resolvedOptions)return(t=e.resolvedOptions().timeZone)&&(t.indexOf("/")>-1||"UTC"===t)&&0!=t.indexOf("Etc")?t:void 0}();return r||(r=s.olson.timezones[n()],void 0!==e.AMBIGUITIES[r]&&(r=a(r))),{name:function(){return r},stdTimezoneOffset:function(){return-n().split(",")[0]},timezoneOffset:function(){return-t(new Date)}}}}}();s.olson=s.olson||{},s.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-660,1,s":"Pacific/Apia","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Asuncion","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Majuro","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},s.olson.dst_rules={years:[2008,2009,2010,2011,2012,2013,2014],zones:[{name:"Africa/Cairo",rules:[{e:12199572e5,s:12090744e5},{e:1250802e6,s:1240524e6},{e:12858804e5,s:12840696e5},!1,!1,!1,{e:14116788e5,s:1406844e6}]},{name:"Africa/Casablanca",rules:[{e:12202236e5,s:12122784e5},{e:12508092e5,s:12438144e5},{e:1281222e6,s:12727584e5},{e:13120668e5,s:13017888e5},{e:13489704e5,s:1345428e6},{e:13828392e5,s:13761e8},{e:14142888e5,s:14069448e5}]},{name:"America/Asuncion",rules:[{e:12050316e5,s:12243888e5},{e:12364812e5,s:12558384e5},{e:12709548e5,s:12860784e5},{e:13024044e5,s:1317528e6},{e:1333854e6,s:13495824e5},{e:1364094e6,s:1381032e6},{e:13955436e5,s:14124816e5}]},{name:"America/Campo_Grande",rules:[{e:12032172e5,s:12243888e5},{e:12346668e5,s:12558384e5},{e:12667212e5,s:1287288e6},{e:12981708e5,s:13187376e5},{e:13302252e5,s:1350792e6},{e:136107e7,s:13822416e5},{e:13925196e5,s:14136912e5}]},{name:"America/Goose_Bay",rules:[{e:122559486e4,s:120503526e4},{e:125704446e4,s:123648486e4},{e:128909886e4,s:126853926e4},{e:13205556e5,s:129998886e4},{e:13520052e5,s:13314456e5},{e:13834548e5,s:13628952e5},{e:14149044e5,s:13943448e5}]},{name:"America/Havana",rules:[{e:12249972e5,s:12056436e5},{e:12564468e5,s:12364884e5},{e:12885012e5,s:12685428e5},{e:13211604e5,s:13005972e5},{e:13520052e5,s:13332564e5},{e:13834548e5,s:13628916e5},{e:14149044e5,s:13943412e5}]},{name:"America/Mazatlan",rules:[{e:1225008e6,s:12074724e5},{e:12564576e5,s:1238922e6},{e:1288512e6,s:12703716e5},{e:13199616e5,s:13018212e5},{e:13514112e5,s:13332708e5},{e:13828608e5,s:13653252e5},{e:14143104e5,s:13967748e5}]},{name:"America/Mexico_City",rules:[{e:12250044e5,s:12074688e5},{e:1256454e6,s:12389184e5},{e:12885084e5,s:1270368e6},{e:1319958e6,s:13018176e5},{e:13514076e5,s:13332672e5},{e:13828572e5,s:13653216e5},{e:14143068e5,s:13967712e5}]},{name:"America/Miquelon",rules:[{e:12255984e5,s:12050388e5},{e:1257048e6,s:12364884e5},{e:12891024e5,s:12685428e5},{e:1320552e6,s:12999924e5},{e:13520016e5,s:1331442e6},{e:13834512e5,s:13628916e5},{e:14149008e5,s:13943412e5}]},{name:"America/Santa_Isabel",rules:[{e:12250116e5,s:1207476e6},{e:12564612e5,s:12389256e5},{e:12885156e5,s:12703752e5},{e:13199652e5,s:13018248e5},{e:13514148e5,s:13332744e5},{e:13828644e5,s:13653288e5},{e:1414314e6,s:13967784e5}]},{name:"America/Santiago",rules:[{e:1206846e6,s:1223784e6},{e:1237086e6,s:12552336e5},{e:127035e7,s:12866832e5},{e:13048236e5,s:13138992e5},{e:13356684e5,s:13465584e5},{e:1367118e6,s:13786128e5},{e:13985676e5,s:14100624e5}]},{name:"America/Sao_Paulo",rules:[{e:12032136e5,s:12243852e5},{e:12346632e5,s:12558348e5},{e:12667176e5,s:12872844e5},{e:12981672e5,s:1318734e6},{e:13302216e5,s:13507884e5},{e:13610664e5,s:1382238e6},{e:1392516e6,s:14136876e5}]},{name:"Asia/Amman",rules:[{e:1225404e6,s:12066552e5},{e:12568536e5,s:12381048e5},{e:12883032e5,s:12695544e5},{e:13197528e5,s:13016088e5},!1,!1,{e:14147064e5,s:13959576e5}]},{name:"Asia/Damascus",rules:[{e:12254868e5,s:120726e7},{e:125685e7,s:12381048e5},{e:12882996e5,s:12701592e5},{e:13197492e5,s:13016088e5},{e:13511988e5,s:13330584e5},{e:13826484e5,s:1364508e6},{e:14147028e5,s:13959576e5}]},{name:"Asia/Dubai",rules:[!1,!1,!1,!1,!1,!1,!1]},{name:"Asia/Gaza",rules:[{e:12199572e5,s:12066552e5},{e:12520152e5,s:12381048e5},{e:1281474e6,s:126964086e4},{e:1312146e6,s:130160886e4},{e:13481784e5,s:13330584e5},{e:13802292e5,s:1364508e6},{e:1414098e6,s:13959576e5}]},{name:"Asia/Irkutsk",rules:[{e:12249576e5,s:12068136e5},{e:12564072e5,s:12382632e5},{e:12884616e5,s:12697128e5},!1,!1,!1,!1]},{name:"Asia/Jerusalem",rules:[{e:12231612e5,s:12066624e5},{e:1254006e6,s:1238112e6},{e:1284246e6,s:12695616e5},{e:131751e7,s:1301616e6},{e:13483548e5,s:13330656e5},{e:13828284e5,s:13645152e5},{e:1414278e6,s:13959648e5}]},{name:"Asia/Kamchatka",rules:[{e:12249432e5,s:12067992e5},{e:12563928e5,s:12382488e5},{e:12884508e5,s:12696984e5},!1,!1,!1,!1]},{name:"Asia/Krasnoyarsk",rules:[{e:12249612e5,s:12068172e5},{e:12564108e5,s:12382668e5},{e:12884652e5,s:12697164e5},!1,!1,!1,!1]},{name:"Asia/Omsk",rules:[{e:12249648e5,s:12068208e5},{e:12564144e5,s:12382704e5},{e:12884688e5,s:126972e7},!1,!1,!1,!1]},{name:"Asia/Vladivostok",rules:[{e:12249504e5,s:12068064e5},{e:12564e8,s:1238256e6},{e:12884544e5,s:12697056e5},!1,!1,!1,!1]},{name:"Asia/Yakutsk",rules:[{e:1224954e6,s:120681e7},{e:12564036e5,s:12382596e5},{e:1288458e6,s:12697092e5},!1,!1,!1,!1]},{name:"Asia/Yekaterinburg",rules:[{e:12249684e5,s:12068244e5},{e:1256418e6,s:1238274e6},{e:12884724e5,s:12697236e5},!1,!1,!1,!1]},{name:"Asia/Yerevan",rules:[{e:1224972e6,s:1206828e6},{e:12564216e5,s:12382776e5},{e:1288476e6,s:12697272e5},{e:13199256e5,s:13011768e5},!1,!1,!1]},{name:"Australia/Lord_Howe",rules:[{e:12074076e5,s:12231342e5},{e:12388572e5,s:12545838e5},{e:12703068e5,s:12860334e5},{e:13017564e5,s:1317483e6},{e:1333206e6,s:13495374e5},{e:13652604e5,s:1380987e6},{e:139671e7,s:14124366e5}]},{name:"Australia/Perth",rules:[{e:12068136e5,s:12249576e5},!1,!1,!1,!1,!1,!1]},{name:"Europe/Helsinki",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]},{name:"Europe/Minsk",rules:[{e:12249792e5,s:12068352e5},{e:12564288e5,s:12382848e5},{e:12884832e5,s:12697344e5},!1,!1,!1,!1]},{name:"Europe/Moscow",rules:[{e:12249756e5,s:12068316e5},{e:12564252e5,s:12382812e5},{e:12884796e5,s:12697308e5},!1,!1,!1,!1]},{name:"Pacific/Apia",rules:[!1,!1,!1,{e:13017528e5,s:13168728e5},{e:13332024e5,s:13489272e5},{e:13652568e5,s:13803768e5},{e:13967064e5,s:14118264e5}]},{name:"Pacific/Fiji",rules:[!1,!1,{e:12696984e5,s:12878424e5},{e:13271544e5,s:1319292e6},{e:1358604e6,s:13507416e5},{e:139005e7,s:1382796e6},{e:14215032e5,s:14148504e5}]},{name:"Europe/London",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]}]},void 0!==e.exports?e.exports=s:null!==n.amdD&&null!=n.amdO?void 0===(r=function(){return s}.apply(t,[]))||(e.exports=r):window.jstz=s}()},4140:(e,t,n)=>{e.exports=n(4042)},4798:e=>{"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};e.exports=function(e,n){void 0===e&&(e={}),void 0===n&&(n=null);var r=e||{},i=[];function s(){i.forEach((function(e){return e(r)}))}return{middleware:n,setState:function(e){r=t({},r,"function"==typeof e?e(r):e),s()},subscribe:function(e){return i.push(e),function(){i.splice(i.indexOf(e),1)}},getState:function(){return r},reset:function(){r=e,s()}}}},1042:(e,t)=>{"use strict";function n(e,t){if(null!=t){if(t.then)return t.then(e.setState);e.setState(t)}}var r=function(e,t){return function(r){return n(e,r.apply(void 0,[e.getState()].concat(t)))}}},5373:(e,t,n)=>{var r=n(4630);e.exports="string"==typeof r?r:r.toString()},5877:(e,t,n)=>{var r=n(3570),i=n(1171),s=i;s.v1=r,s.v4=i,e.exports=s},5327:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},5217:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},3570:(e,t,n)=>{var r,i,s=n(5217),a=n(5327),o=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],d=(e=e||{}).node||r,h=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==h){var f=s();null==d&&(d=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=i=16383&(f[6]<<8|f[7]))}var v=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,p=v-o+(m-c)/1e4;if(p<0&&void 0===e.clockseq&&(h=h+1&16383),(p<0||v>o)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=v,c=m,i=h;var g=(1e4*(268435455&(v+=122192928e5))+m)%4294967296;l[u++]=g>>>24&255,l[u++]=g>>>16&255,l[u++]=g>>>8&255,l[u++]=255&g;var b=v/4294967296*1e4&268435455;l[u++]=b>>>8&255,l[u++]=255&b,l[u++]=b>>>24&15|16,l[u++]=b>>>16&255,l[u++]=h>>>8|128,l[u++]=255&h;for(var y=0;y<6;++y)l[u+y]=d[y];return t||a(l)}},1171:(e,t,n)=>{var r=n(5217),i=n(5327);e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||i(a)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";n.d(r,{default:()=>ot});n(1181);let e;!function(e){e[e.DISABLED=0]="DISABLED",e[e.TRANSACTIONS=1]="TRANSACTIONS",e[e.PAYLOAD=2]="PAYLOAD",e[e.FULL_DETAIL=3]="FULL_DETAIL"}(e||(e={}));const t=t=>{const n=["AtomicSDK Web -"];return i.logLevel>=e.TRANSACTIONS&&t.level1&&n.push(...t.level1),i.logLevel>=e.PAYLOAD&&t.level2&&n.push(...t.level2),i.logLevel>=e.FULL_DETAIL&&t.level3&&n.push(...t.level3),n},i={logLevel:e.DISABLED,debug:n=>{i.logLevel!==e.DISABLED&&(n.level1||n.level2||n.level3)&&console.log(...t(n))},warn:n=>{i.logLevel!==e.DISABLED&&(n.level1||n.level2||n.level3)&&console.warn(...t(n))},error:n=>{i.logLevel!==e.DISABLED&&(n.level1||n.level2||n.level3)&&console.error(...t(n))}};var s=n(4140),a=n.n(s);n(4798),n(1042);const o="io.atomic.events.cardCountChanged",c="io.atomic.events.ready",u="io.atomic.events.sdkLogout",l="io.atomic.events.resolveRuntimeVariables",d="io.atomic.events.requestRuntimeVariables",h="io.atomic.events.linkButtonPressed",f="io.atomic.events.submitButtonPressed",v="io.atomic.events.didUpdateAppOpen",m="io.atomic.events.frameHeightChanged",p="io.atomic.events.analyticsEventReceived",g="io.atomic.events.errorReceived",b="io.atomic.events.cardEventReceived",y="io.atomic.events.authTokenRequested",I="io.atomic.events.authTokenReceived",k="io.atomic.events.authTokenError",S="io.atomic.events.cardFeedSubscribeRequested",w="io.atomic.events.subscriptionRetryExceeded",T="io.atomic.events.cardFeedUnsubscribeRequested",A="io.atomic.events.cardFeedUpdateReceived",C="io.atomic.events.pollingFallbackEnabled",E="io.atomic.events.pollingFallbackDisabled",D="io.atomic.events.socketReconnectionRequested",x="io.atomic.events.socketConnectionHealthcheck",O="io.atomic.events.cardFeedSubscriptionId",M="io.atomic.events.socketAuthenticationError",N="io.atomic.events.feedSubscribeError",R="io.atomic.events.streamFilterApplied",P="io.atomic.events.invalidStreamContainerId",F="io.atomic.events.invalidFilter",L="io.atomic.events.invalidToken",Y="io.atomic.events.expiredToken",q="sdkInitialisation",H="displayedCards";var W=n(7292);W.addYears,W.addMonths,W.addWeeks,W.addDays,W.addHours,W.addMinutes,W.addSeconds;const j=e=>{if("string"!=typeof e)return!1;const t=new Date(e);if(t instanceof Date)try{return t.toISOString()===e}catch(e){return!1}return!1},_=e=>{if(!U(e))throw new Error("JWT supplied has an incorrect format");try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=atob(t);return JSON.parse(n)}catch(e){throw new Error("JWT payload could not be parsed")}},U=e=>!!e.match(/^[\w-]+\.[\w-]+\.[\w-]*$/),$=e=>{const t=Math.floor((new Date).getTime()/1e3);return 1===(0,W.compareAsc)(t,e)},V=()=>{const e=sessionStorage.getItem(H),t=e?JSON.parse(e):void 0;return new Set(t)},K=e=>"object"==typeof e&&null!==e&&!Array.isArray(e);var B=n(5877),z=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const G=3e4,J="YYYY-MM-DDTHH:mm:ss.SSSZ",X=e=>{if(!e)return null;try{const t=_(e);let n=t.atomic_sub||t.sub||null;return"number"==typeof n&&(n=String(n)),"string"==typeof n?n:null}catch(e){return null}},Z="AtomicAnalyticsQueue";var ee=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ne={noInternet:"AACNoInternetError",missingApiHost:"AACMissingApiHostError",apiError:"AACApiError",invalidParameters:"AACInvalidParametersError",notPermitted:"AACOperationNotPermittedError",authTokenError:"AACAuthTokenError"},re={noInternet:"Device is not connected to the internet",missingApiHost:"API host was not specified for the request.",apiError:"An API error occurred.",invalidParameters:"Parameters supplied to the API request were invalid.",notPermitted:"This API request is not permitted.",authTokenError:"Failed to retrieve an authentication token for request."},ie="An authentication token was required for the request, however no token was returned.",se="The auth token provided is not a valid JWT.",ae={method:"GET",mode:"cors"},oe=e=>ee(void 0,void 0,void 0,(function*(){const t=yield e.text();try{return{text:t,json:JSON.parse(t)}}catch(e){}return{text:t}})),ce=e=>e<400,ue=(e,t,n,r)=>{var i;const s=null!==(i=X(n))&&void 0!==i?i:void 0;!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;const r={bubbles:!1,cancelable:!1,detail:t};let i=new CustomEvent(e,r);n.dispatchEvent(i)}("request-failed",{request:{path:e,statusCode:t,streamContainerId:"string"==typeof(null==r?void 0:r.streamContainerId)?null==r?void 0:r.streamContainerId:void 0,cardInstanceId:"string"==typeof(null==r?void 0:r.cardInstanceId)?null==r?void 0:r.cardInstanceId:void 0,endUserId:s}})};class le{static initialise(e,t,n){this.apiHost=e,this.apiKey=t,this.environmentId=n,this.instanceId=(0,B.v4)()}static reset(){this.apiHost="https://client-api.atomic.io",this.apiKey=void 0,this.environmentId=void 0}static setTestHostHeader(e){this.testHost=e}static setClientAppVersion(e){this.clientAppVersion=e}static verifyInitialised(){if(!this.isInitialised())throw new Error("The Atomic SDK has not been initialised with an API host, API key and environment ID. Call `AtomicSDK.initialise(apiHost, apiKey, environmentId)` before attempting to use the SDK.")}static isInitialised(){return void 0!==this.apiKey&&void 0!==this.environmentId}static get(e,t,n,r){return ee(this,void 0,void 0,(function*(){let i,s;if(this.verifyInitialised(),!navigator.onLine){const e=new Error(re.noInternet);return e.name=ne.noInternet,{response:{error:e}}}{const a=ve(this.apiHost,e,this.environmentId);if(!a){const e=new Error(re.missingApiHost);return e.name=ne.missingApiHost,{response:{error:e}}}let o;if(t)try{o=yield t.requestToken()}catch(e){const t=new Error(`${re.authTokenError} ${e}`);return t.name=ne.authTokenError,{response:{error:t}}}const c=Object.assign(Object.assign({},ae),{headers:de({instanceId:this.instanceId,apiKey:this.apiKey,authToken:o,lastModified:n,testHost:this.testHost,clientAppVersion:this.clientAppVersion})});try{const t=yield fetch(a,c);s=t.status;const n=yield oe(t);if(n.json&&(i=n.json),!ce(t.status))throw ue(e,s,o,r),new Error(`GET request failed with status code ${t.status}.`);return{data:i,response:{status:t.status,etag:t.headers.get("etag")}}}catch(e){const t=new Error(`${re.apiError} ${e}`);return t.name=ne.apiError,{data:i,response:{status:s,error:t}}}}}))}static post(e,t,n,r){return ee(this,void 0,void 0,(function*(){if(this.verifyInitialised(),!navigator.onLine){const e=new Error(re.noInternet);return e.name=ne.noInternet,{response:{error:e}}}{let i,s;const a=ve(this.apiHost,e,this.environmentId);if(!a){const e=new Error(re.missingApiHost);return e.name=ne.missingApiHost,{response:{error:e}}}let o;if(n)try{o=yield n.requestToken()}catch(e){const t=new Error(`${re.authTokenError} ${e}`);return t.name=ne.authTokenError,{response:{error:t}}}const c=Object.assign(Object.assign({},ae),{method:"POST",headers:de({instanceId:this.instanceId,apiKey:this.apiKey,authToken:o,testHost:this.testHost,clientAppVersion:this.clientAppVersion}),body:JSON.stringify(t)});try{const t=yield fetch(a,c);s=t.status;const n=yield oe(t);if(n.json&&(i=n.json),!ce(t.status))throw ue(e,s,o,r),new Error(`POST request failed with status code ${t.status}.`);return{data:i,response:{status:t.status}}}catch(e){const t=new Error(`${re.apiError} ${e}`);return t.name=ne.apiError,{data:i,response:{status:s,error:t}}}}}))}static put(e,t,n,r){return ee(this,void 0,void 0,(function*(){if(this.verifyInitialised(),!navigator.onLine){const e=new Error(re.noInternet);return e.name=ne.noInternet,{response:{error:e}}}{let i,s;const a=ve(this.apiHost,e,this.environmentId);if(!a){const e=new Error(re.missingApiHost);return e.name=ne.missingApiHost,{response:{error:e}}}let o;if(n)try{o=yield n.requestToken()}catch(e){const t=new Error(`${re.authTokenError} ${e}`);return t.name=ne.authTokenError,{response:{error:t}}}const c=Object.assign(Object.assign({},ae),{method:"PUT",headers:de({instanceId:this.instanceId,apiKey:this.apiKey,authToken:o,testHost:this.testHost,clientAppVersion:this.clientAppVersion}),body:JSON.stringify(t)});try{const t=yield fetch(a,c);s=t.status;const n=yield oe(t);if(n.json&&(i=n.json),!ce(t.status))throw ue(e,s,o,r),new Error(`PUT request failed with status code ${t.status}.`);return{data:i,response:{status:t.status}}}catch(e){const t=new Error(`${re.apiError} ${e}`);return t.name=ne.apiError,{data:i,response:{status:s,error:t}}}}}))}static delete(e,t,n,r){return ee(this,void 0,void 0,(function*(){if(this.verifyInitialised(),!navigator.onLine){const e=new Error(re.noInternet);return e.name=ne.noInternet,{response:{error:e}}}{let i,s;const a=ve(this.apiHost,e,this.environmentId);if(!a){const e=new Error(re.missingApiHost);return e.name=ne.missingApiHost,{response:{error:e}}}let o;if(n)try{o=yield n.requestToken()}catch(e){const t=new Error(`${re.authTokenError} ${e}`);return t.name=ne.authTokenError,{response:{error:t}}}const c=Object.assign(Object.assign({},ae),{method:"DELETE",headers:de({instanceId:this.instanceId,apiKey:this.apiKey,authToken:o,testHost:this.testHost,clientAppVersion:this.clientAppVersion}),body:JSON.stringify(t)});try{const t=yield fetch(a,c);s=t.status;const n=yield oe(t);if(n.json&&(i=n.json),!ce(t.status))throw ue(e,s,o,r),new Error(`DELETE request failed with status code ${t.status}.`);return{data:i,response:{status:t.status}}}catch(e){const t=new Error(`${re.apiError} ${e}`);return t.name=ne.apiError,{data:i,response:{status:s,error:t}}}}}))}}te(le,"apiHost","https://client-api.atomic.io"),te(le,"apiKey",void 0),te(le,"environmentId",void 0),te(le,"instanceId",void 0),te(le,"testHost",void 0),te(le,"clientAppVersion","unknown");const de=e=>fe("header",Object.assign({},e)),he=(e,t)=>{let n=fe("query",Object.assign({},t));for(const t in n)e.searchParams.set(t.toLowerCase(),n[t]);return e},fe=(e,t)=>{const n="header"===e;let r={"x-atomic-sdk-platform":"Web","x-atomic-sdk-version":"23.3.2","x-atomic-sdk-timezone":a().determine().name(),"x-atomic-sdk-device":navigator.userAgent};if(t.instanceId&&(r["x-atomic-sdk-instance-id"]=t.instanceId),n&&(r["Content-Type"]="application/json"),t.apiKey){r["ws"===t.scheme?"api-key":"x-atomic-sdk-api-key"]=t.apiKey}return t.authToken&&(n?r.Authorization=`Bearer ${t.authToken}`:r.Token=t.authToken),t.lastModified&&n&&(r["If-None-Match"]=t.lastModified),t.testHost&&(r["x-atomic-test-host"]=t.testHost),t.clientAppVersion&&(r["x-atomic-sdk-client-app-version"]=t.clientAppVersion),t.error&&(r.error=t.error),r},ve=(e,t,n)=>{if(!e||0==e.trim().length)return null;return`${e.endsWith("/")?e:`${e}/`}${n&&n.trim().length>0?`${n}/`:""}${t}`};var me=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};const pe=(e,t)=>me(void 0,void 0,void 0,(function*(){var n,r;(null===(n=e.preferences)||void 0===n?void 0:n.notifications)&&ge(e);const{data:s,response:a}=yield le.put("update-user",e,t);return(null==s?void 0:null===(r=s.errors)||void 0===r?void 0:r.length)&&i.error({level1:["Errors detected with user update:",...s.errors.map(e=>null==e?void 0:e.title)]}),a.error?{ok:!1,error:a.error}:{ok:200===a.status}})),ge=e=>{var t;const n=[],r=["mon","tue","wed","thu","fri","sat","sun","default"];if(null===(t=e.preferences)||void 0===t?void 0:t.notifications){for(const[t,i]of Object.entries(null===(s=e.preferences)||void 0===s?void 0:s.notifications)){var s;if(!r.includes(t)){n.push(`Invalid key provided for "${t}", notification preferences can only be provided for the following keys: ${r.toString()}`);continue}if(!(null==i?void 0:i.length))continue;const a=i.map(e=>{const{from:r,to:i}=e,s=e=>`${e.hours.toString().padStart(2,"0")}:${e.minutes.toString().padStart(2,"0")}`;if(!r&&!i||r&&!i||!r&&i)n.push(`Invalid notification range provided for ${t}, both a "from" & "to" value are required`);else if(isNaN(r.hours)||isNaN(r.minutes)||isNaN(i.hours)||isNaN(i.minutes))n.push(`Invalid notification range provided for ${t}, non-numeric value provided for "from" or "to"`);else if(r.hours>23||r.hours<0||i.hours>23||i.hours<0)n.push(`Invalid notification range provided for ${t}, hours must be between 0 & 23 inclusive`);else if(r.minutes>59||r.minutes<0||i.minutes>59||i.minutes<0)n.push(`Invalid notification range provided for ${t}, minutes must be between 0 & 59 inclusive`);else{if(!(r.hours>i.hours))return{from:s(r),to:s(i)};n.push(`Invalid notification range provided for ${t}, end time must be earlier than start time`)}});e.preferences.notifications[t]=a}n.length&&(i.warn({level1:n}),delete e.preferences.notifications)}},be={CUSTOM_PING:"custom-ping",AUTH:"auth",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",EVENTS:"events"},ye={CUSTOM_PONG:"custom-pong",AUTH_SUCCESS:"auth-success",TOKEN_EXPIRY:"token-expiry",UPDATE_CARDS:"update-cards",EVENTS_PROCESSED:"events-processed",ERROR:"error"},Ie={INVALID_TOKEN:"invalid-token",EXPIRED_TOKEN:"expired-token",INVALID_STREAM_CONTAINER_ID:"invalid-stream-container-id",INVALID_FILTER:"invalid-filter",INVALID_MESSAGE:"invalid-message"};function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let Se;!function(e){e[e.notPermitted=1013]="notPermitted",e[e.missingApi=1008]="missingApi",e[e.retryConnection=1011]="retryConnection",e[e.goingAway=1001]="goingAway",e[e.abnormalClosure=1006]="abnormalClosure",e[e.sdkClosedConnection=3e3]="sdkClosedConnection",e[e.sdkChangingProtocol=3001]="sdkChangingProtocol",e[e.sdkReinitialisedWebSocket=3002]="sdkReinitialisedWebSocket",e[e.sdkSessionEnding=3003]="sdkSessionEnding",e[e.sdkCordovaBackgrounded=3004]="sdkCordovaBackgrounded",e[e.unitTestConnectionClose=3005]="unitTestConnectionClose"}(Se||(Se={}));const we={notInitialised:{name:"Not initialised",message:"WebSocket client has not been initialised"},noConnection:{name:"No connection",message:"WebSocket connection is not established"},notReady:{name:"WebSocket not ready",message:"WebSocket connection is not ready to send message"},dispatchMessage:{name:"Dispatch message error",message:"Unable to dispatch the client message on the WebSocket connection"}};class Te{static initialise(e,t,n){try{const t=new URL(e);t.protocol="https:"===t.protocol?"wss":"ws",this.apiHost=t.toString()}catch(e){i.error({level1:["error creating WebSocket URL from supplied API host"],level2:[e]})}window.addEventListener("beforeunload",()=>{i.debug({level3:["WebSocket client beforeunload event triggered, closing WebSocket connection"]}),this.close(Se.sdkSessionEnding,"Connection closed by SDK, clean up WebSocket connection as page has unloaded")}),window.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&(i.debug({level3:[`WebSocket client visibilitychange event triggered, page is ${document.visibilityState} checking connection health`]}),this.connectionHealthCheck())}),document.addEventListener("pause",()=>{i.debug({level3:["Cordova app pause event triggered"]}),this.close(Se.sdkCordovaBackgrounded,"Connection closed by SDK, clean up WebSocket connection as app has been backgrounded")},!1),document.addEventListener("resume",()=>{i.debug({level3:["Cordova app resume event triggered"]}),ot.reinitialiseWebSocketConnection()},!1),this.apiKey=t,this.environmentId=n,this.isConnected()&&this.close(Se.sdkReinitialisedWebSocket,"Connection closed by SDK, WebSocket has been reinitialised")}static isInitialised(){return void 0!==this.apiKey&&void 0!==this.environmentId&&void 0!==this.apiHost}static reset(){this.apiHost=void 0,this.apiKey=void 0,this.environmentId=void 0,this.openingConnection=!1,this.connectionAuthenticated=!1,this.webSocketConnection=void 0,this.connectionTimeout=void 0,this.pingTimeout=void 0}static setConnectionTimeout(){this.clearTimeouts(),this.connectionTimeout=setTimeout(()=>{try{this.dispatchMessage({messageType:be.CUSTOM_PING})}catch(e){i.error({level3:["Error sending custom ping message:",e]})}this.pingTimeout=setTimeout(()=>{i.debug({level3:["WebSocket client ping timeout reached, closing connection"]}),this.close(Se.sdkClosedConnection,"connection timed out")},this.connectionTimer)},this.connectionTimer)}static setClientAppVersion(e){this.clientAppVersion=e}static connectionHealthCheck(){Te.isInitialised()&&Te.isConnected()&&xe.lastPongSuccess&&(0,W.differenceInMilliseconds)((new Date).toISOString(),xe.lastPongSuccess)>this.staleConnectionTimer&&(i.debug({level3:["WebSocket connection has become stale, re-initialising"]}),ot.reinitialiseWebSocketConnection())}static clearTimeouts(){this.connectionTimeout&&clearTimeout(this.connectionTimeout),this.pingTimeout&&clearTimeout(this.pingTimeout)}static isConnected(){return!this.openingConnection&&!!this.webSocketConnection&&this.webSocketConnection.readyState==this.webSocketConnection.OPEN}static close(e,t){var n;e===Se.sdkSessionEnding&&xe.unsubscribeActiveSubscriptions(),null===(n=this.webSocketConnection)||void 0===n||n.close(e,t),this.connectionAuthenticated=!1,this.clearTimeouts()}static purgeMessageQueue(){this.messageQueue.length&&(this.messageQueue.forEach(e=>{let t;switch(e.messageType){case be.SUBSCRIBE:t=e,t.data.subscriptions=t.data.subscriptions.filter(e=>Object.keys(ot.streamContainers).includes(e.subscriptionId)),t.data.subscriptions.length||(t=null);break;default:t=e}try{t&&this.dispatchMessage(t),i.debug({level3:["WebSocket client purging message queue, message sent by WebSockets: ",t]})}catch(e){i.error({level1:["purging message queue, error sending message"],level2:[e]})}}),this.messageQueue=[])}static dispatchMessage(e){var t;const n=(0,B.v4)(),r=Object.assign(Object.assign({},e),{messageId:n}),i=JSON.stringify(r);try{const t=this.webSocketConnection;if(!t)throw new Error(we.noConnection.message);if(t.readyState===t.CLOSING||t.readyState===t.CLOSED)throw new Error(we.notReady.message);return t.readyState===t.CONNECTING?this.messageQueue.push(e):t.send(i)}catch(e){const n=new Error;throw n.name=we.dispatchMessage.name,n.message=null!==(t=e.message)&&void 0!==t?t:we.dispatchMessage.message,n}}static setEventListeners(e,t){e.onmessage=e=>{if(this.setConnectionTimeout(),e.data)try{const n=JSON.parse(e.data);t.onMessage(n)}catch(e){console.error(e)}},e.onopen=()=>{var e;this.setConnectionTimeout(),null===(e=t.onOpen)||void 0===e||e.call(t)},e.onclose=e=>{var n;null===(n=t.onClose)||void 0===n||n.call(t,e)},e.onerror=e=>{t.onError(e)}}static open(e,t,n){try{if(this.openingConnection=!0,!this.isInitialised())throw new Error(we.notInitialised.message);if(!navigator.onLine){const e=new Error(re.noInternet);throw e.name=ne.noInternet,e}const r=ve(this.apiHost,e,this.environmentId);if(!r){const e=new Error(re.missingApiHost);throw e.name=ne.missingApiHost,e}this.webSocketConnection&&this.webSocketConnection.readyState==this.webSocketConnection.OPEN&&this.close(Se.sdkReinitialisedWebSocket,"Connection closed by SDK, request to open new connection received");const i=he(new URL(r),Object.assign({apiKey:this.apiKey,scheme:"ws",clientAppVersion:this.clientAppVersion},n?{error:n}:{}));this.webSocketConnection=new WebSocket(i.toString()),this.setEventListeners(this.webSocketConnection,t),this.openingConnection=!1}catch(e){throw this.openingConnection=!1,e}}}ke(Te,"apiHost",void 0),ke(Te,"apiKey",void 0),ke(Te,"environmentId",void 0),ke(Te,"clientAppVersion","unknown"),ke(Te,"openingConnection",!1),ke(Te,"authenticatingConnection",!1),ke(Te,"connectionAuthenticated",!1),ke(Te,"authenticationTimeout",7e3),ke(Te,"messageQueue",[]),ke(Te,"webSocketConnection",void 0),ke(Te,"connectionTimeout",void 0),ke(Te,"pingTimeout",void 0),ke(Te,"connectionTimer",3e4),ke(Te,"staleConnectionTimer",2*Te.connectionTimer+5e3);var Ae=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ee={invalidStreamContainerId:{name:"Invalid stream container id",message:"an invalid stream container id was provided with the subscription request"},invalidFilter:{name:"Invalid filter",message:"an invalid filter was provided with the subscription request"}},De={invalidToken:{name:"Invalid token",message:'Atomic platform responded with an "invalid token" message'},expiredToken:{name:"Expired token",message:'Atomic platform responded with an "expired token" message'}};class xe{static reset(){this.activeSubscriptions={},this.lastPongSuccess=void 0}static messageSubscribedContainer(e,t){ot.streamContainers[e].sendMessageToIframe(t)}static messageAllSubscribedContainers(e){Object.values(this.activeSubscriptions).forEach(t=>{this.messageSubscribedContainer(t.subscriptionId,e)})}static handleWebSocketMessage(e){return Ae(this,void 0,void 0,(function*(){switch(e.messageType){case ye.CUSTOM_PONG:i.debug({level1:["pong received by WebSockets"],level2:[e]}),this.lastPongSuccess=(new Date).toISOString();break;case ye.AUTH_SUCCESS:Te.connectionAuthenticated||(Te.connectionAuthenticated=!0,ot.authMessageResolve()),i.debug({level1:["auth success received by WebSockets"],level2:[e]});break;case ye.TOKEN_EXPIRY:i.debug({level1:["token expiry received by WebSockets"],level2:[e]}),Te.connectionAuthenticated=!1;try{yield ot.handleTokenRequest({skipCache:!0,authWebSocket:!0}),this.resubscribeActiveSubscriptions()}catch(e){i.error({level1:["Token expired, new token request failed"],level2:[e]})}break;case ye.UPDATE_CARDS:{i.debug({level1:["update cards received by WebSockets"],level2:[e]});const t=e.data.updates,n={};null==t||t.forEach(e=>{const{subscriptionId:t}=e.data;n[t]||(n[t]=[]),n[t].push(e)}),Object.keys(n).forEach(e=>{this.messageSubscribedContainer(e,{action:A,values:{cardFeedUpdates:n[e]}})});break}case ye.EVENTS_PROCESSED:{var t;i.debug({level1:["analytics events processed received by WebSockets"],level2:[e]});const n=null===(t=e.data)||void 0===t?void 0:t.eventIds;n&&Array.isArray(n)&&ot.analyticsQueue.removeProcessedEvents(n);break}case ye.ERROR:this.handleWebSocketErrorMessage(e);break;default:i.debug({level1:["unknown message received by WebSockets"],level2:[e]})}}))}static handleWebSocketErrorMessage(e){var t,n,r;return Ae(this,void 0,void 0,(function*(){switch(e.data.errorType){case Ie.INVALID_TOKEN:{const e=new Error(De.invalidToken.message);e.name=De.invalidToken.name,i.error({level1:["Invalid token error received by WebSockets."],level2:[e]}),Te.connectionAuthenticated||ot.authMessageReject(e),Te.connectionAuthenticated=!1;try{yield ot.handleTokenRequest({skipCache:!0,authWebSocket:!0}),this.resubscribeActiveSubscriptions()}catch(e){i.error({level1:["Token invalid, new token request failed"],level2:[e]}),this.messageAllSubscribedContainers({action:L,values:null!==(t=e.message)&&void 0!==t?t:e})}break}case Ie.EXPIRED_TOKEN:{const t=new Error(null!==(n=e.data.errorMessage)&&void 0!==n?n:De.expiredToken.message);t.name=De.expiredToken.name,i.error({level1:["Expired token error received by WebSockets"],level2:[t]}),Te.connectionAuthenticated||ot.authMessageReject(t),Te.connectionAuthenticated=!1;try{yield ot.handleTokenRequest({skipCache:!0,authWebSocket:!0}),this.resubscribeActiveSubscriptions()}catch(e){i.error({level1:["Token expired, new token request failed"],level2:[e]}),this.messageAllSubscribedContainers({action:Y,values:null!==(r=e.message)&&void 0!==r?r:e})}break}case Ie.INVALID_STREAM_CONTAINER_ID:{var s;const t=e.data.subscriptionId,n=new Error(`${Ee.invalidStreamContainerId.message} - ${null===(s=this.activeSubscriptions[t])||void 0===s?void 0:s.streamContainerId}`);n.name=Ee.invalidStreamContainerId.name,i.error({level1:["Invalid stream container id error received by WebSockets"],level2:[n]}),this.messageSubscribedContainer(t,{action:P,values:n.message});break}case Ie.INVALID_FILTER:{const t=e.data.subscriptionId,n=new Error(Ee.invalidFilter.message);n.name=Ee.invalidFilter.name,n.message=Ee.invalidFilter.message,i.error({level1:["Invalid filter error received by WebSockets"],level2:[n]}),this.messageSubscribedContainer(t,{action:F,values:n.message});break}case Ie.INVALID_MESSAGE:i.error({level1:["Invalid message error received by WebSockets"],level2:[e]});break;default:i.debug({level1:["unknown error received by WebSockets"],level2:[e]})}}))}static subscribeToCardFeed(e){try{Te.dispatchMessage({messageType:be.SUBSCRIBE,data:{subscriptions:e}}),e.forEach(e=>this.activeSubscriptions[e.subscriptionId]=e)}catch(e){throw i.error({level1:["Error subscribing to card feed via WebSocket"],level2:[e]}),e}}static unsubscribeFromCardFeed(e){try{Te.dispatchMessage({messageType:be.UNSUBSCRIBE,data:{subscriptionIds:e}}),e.forEach(e=>delete this.activeSubscriptions[e])}catch(e){i.error({level1:["Error unsubscribing from card feed via WebSocket"],level2:[e]})}}static resubscribeActiveSubscriptions(){const e=Object.values(this.activeSubscriptions);e.length&&(this.subscribeToCardFeed(e),e.forEach(e=>this.messageSubscribedContainer(e.subscriptionId,{action:E})))}static unsubscribeActiveSubscriptions(){const e=Object.values(this.activeSubscriptions);e.length&&this.unsubscribeFromCardFeed(e.map(e=>e.subscriptionId))}static sendAuthMessage(e){try{Te.dispatchMessage({messageType:be.AUTH,authToken:e})}catch(e){i.error({level1:["Error sending auth message to WebSocket"],level2:[e]})}}static sendAnalyticsMessage(e,t){if(!ot.webSocketDisabled&&Te.isConnected())try{Te.dispatchMessage({messageType:be.EVENTS,authToken:t,data:{events:e}})}catch(e){i.error({level1:["Error sending analytics message to WebSocket"],level2:[e]})}}}Ce(xe,"activeSubscriptions",{}),Ce(xe,"lastPongSuccess",void 0);function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Me{constructor(e){var t,n,r,i,s;Oe(this,"totals",void 0),Oe(this,"metricsByContainer",void 0);const a=V();let o={active:0,unseen:0};(null==e?void 0:null===(t=e.aggregates)||void 0===t?void 0:null===(n=t.cards)||void 0===n?void 0:n.total)&&(o.active=e.aggregates.cards.total.active,o.unseen=e.aggregates.cards.total.unseenCardInstanceIds.filter(e=>!a.has(e)).length),this.totals=o,this.metricsByContainer=(null==e?void 0:null===(r=e.aggregates)||void 0===r?void 0:null===(i=r.cards)||void 0===i?void 0:null===(s=i.byContainer)||void 0===s?void 0:s.reduce((e,t)=>(e[t.containerId]={unseen:t.unseenCardInstanceIds.filter(e=>!a.has(e)).length,active:t.active},e),{}))||{}}unseenCards(){return this.totals.unseen||0}totalCards(){return this.totals.active||0}unseenCardsForStreamContainer(e){var t;return(null===(t=this.metricsByContainer[e])||void 0===t?void 0:t.unseen)||0}totalCardsForStreamContainer(e){var t;return(null===(t=this.metricsByContainer[e])||void 0===t?void 0:t.active)||0}}const Ne={SDK_INITIALIZED:"sdk-initialized",CARD_DISPLAYED:"card-displayed",USER_REDIRECTED:"user-redirected",CARD_VOTED_UP:"card-voted-up",CARD_VOTED_DOWN:"card-voted-down",RUNTIME_VARS_UPDATED:"runtime-vars-updated",STREAM_DISPLAYED:"stream-displayed",SNOOZE_OPTIONS_DISPLAYED:"snooze-options-displayed",SNOOZE_OPTIONS_CANCELED:"snooze-options-canceled",CARD_SUBVIEW_DISPLAYED:"card-subview-displayed",CARD_SUBVIEW_EXITED:"card-subview-exited",REQUEST_FAILED:"request-failed",VIDEO_PLAYED:"video-played",VIDEO_COMPLETED:"video-completed",NOTIFICATION_RECEIVED:"notification-received"};function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Pe=e=>{const t=new Error(e);return t.name="Stream filter error",i.error({level1:[t]}),t},Fe=(e,t)=>{let n=!0;return!!e.length&&(e.reduce((e,r)=>(t.includes(typeof r)||(n=!1),typeof e!=typeof r&&(n=!1),r)),n)};class Le{constructor(e,t){Re(this,"filters",void 0),Re(this,"onApplyFilter",void 0),Re(this,"onClearFilter",void 0),Re(this,"addVariableFilter",e=>{if(!e)throw Pe("The name of the variable you are filtering by must be supplied to `addVariableFilter`");return Ye(this.filters,"variables",e,e=>{const t=Array.isArray(e);if(!t&&!["string","number","boolean","null"].includes(typeof e))throw Pe('Incorrect value provided for "variable" filter. Must be a string, a number, a boolean or null.');if(t&&!Fe(e,["string","number"]))throw Pe('Incorrect value provided for "variable" filter, for "in" or "notIn" must be either an array of numbers or an array of strings.')},["equals","greaterThan","greaterThanOrEqualTo","in","lessThan","lessThanOrEqualTo","notEqualTo","notIn","between"])}),Re(this,"addCardTemplateIdFilter",()=>{return Ye(this.filters,"metadata","cardTemplateId",e=>{const t=Array.isArray(e);if(!t&&"string"!=typeof e)throw Pe('Incorrect "card template id" filter value provided, must be a string.');if(t&&!Fe(e,["string"]))throw Pe('Incorrect "card template id" filter value provided, for "in" or "notIn" an array of strings must be supplied.')},["equals","in","notEqualTo","notIn"])}),Re(this,"addCardTemplateNameFilter",()=>{return Ye(this.filters,"metadata","cardTemplateName",e=>{const t=Array.isArray(e);if(!t&&"string"!=typeof e)throw Pe('Incorrect "card template name" filter value provided, must be a string.');if(t&&!Fe(e,["string"]))throw Pe('Incorrect "card template name" filter value provided, for "in" or "notIn" an array of strings must be supplied.')},["equals","in","notEqualTo","notIn"])}),Re(this,"addCardCreatedFilter",()=>{return Ye(this.filters,"metadata","created",e=>{if("string"!=typeof e||!j(e))throw Pe('Incorrect "card created" filter value provided, must be a valid ISO date string')},["equals","greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo","notEqualTo"])}),Re(this,"addCardPriorityFilter",()=>{return Ye(this.filters,"metadata","priority",e=>{const t=typeof e,n=Array.isArray(e);if(n&&!Fe(e,["number"]))throw Pe('Incorrect "card priority" filter value provided. For "in" and "notIn" must be a number between 1 & 10 inclusive.');if(n){let t=!1;if(e.forEach(e=>{(e>10||e<1)&&(t=!0)}),t)throw Pe('Incorrect "card priority" filter value provided. For "in" and "notIn" must be a number between 1 & 10 inclusive.')}else if(!n&&"number"!==t||isNaN(e)||e>10||e<1)throw Pe('Incorrect "card priority" filter value provided, must be a number between 1 & 10 inclusive.')},["equals","greaterThan","greaterThanOrEqualTo","in","lessThan","lessThanOrEqualTo","notEqualTo","notIn","between"])}),Re(this,"clearFilters",()=>{this.filters={},this.onClearFilter()}),Re(this,"apply",()=>{this.onApplyFilter()}),Re(this,"getFilterObject",()=>this.filters),this.filters={},this.onApplyFilter=e,this.onClearFilter=t}}const Ye=(e,t,n,r,i)=>{const s=(i,s)=>a=>{r(a),((e,t,n)=>{const r=typeof t;switch(e){case"eq":case"ne":if(!["number","string","boolean","null"].includes(r))throw Pe(`Operator "${n}" must be a number, string, boolean or null`);break;case"gt":case"gte":case"lt":case"lte":if(!["string","number"].includes(r))throw Pe(`Operator "${n}" must be a number or ISO date string`);if("string"===r&&!j(t))throw Pe(`Operator "${n}" must be a number or ISO date string`);break;case"in":case"nin":if(!Array.isArray(t))throw Pe(`Operator "${n}" must be either an array of numbers or an array of strings`);if(!Fe(t,["string","number"]))throw Pe(`Operator "${n}" must be either an array of numbers or an array of strings`);break;case"between":if(2!==t.length||!Fe(t,["number"]))throw Pe(`Operator "${n}" must be an array of 2 numbers: [minimumValue, maximumValue]`)}})(i,a,s),e[`${t}.${n}__${i}`]=a},a={equals:s("eq","equals"),greaterThan:s("gt","greaterThan"),greaterThanOrEqualTo:s("gte","greaterThanOrEqualTo"),in:s("in","in"),lessThan:s("lt","lessThan"),lessThanOrEqualTo:s("lte","lessThanOrEqualto"),notEqualTo:s("ne","notEqualTo"),notIn:s("nin","notIn"),between:s("between","between")};return Object.keys(a).forEach(e=>{i.includes(e)||delete a[e]}),a};var qe=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};let He;const We=e=>{const t=Ve(e);if(t.success)return He=e,!0;{const e=`Device info set with invalid parameters: ${t.errors.join("\n")}`;throw console.error(e),new Error(e)}},je=(e,t,n)=>qe(void 0,void 0,void 0,(function*(){Ke();let r=Object.assign({deviceId:He.deviceId,appId:He.appId,streamContainerIds:e},n?{notificationsEnabled:n}:{});const{data:i,response:s}=yield le.put("register-containers",r,t);if(Be(je.name,i),s.error)throw s.error;return 200===s.status})),_e=(e,t)=>qe(void 0,void 0,void 0,(function*(){Ke();let n={token:e,deviceId:He.deviceId,appId:He.appId,platform:He.platform};const{data:r,response:i}=yield le.put("register",n,t);if(Be(_e.name,r),i.error)throw i.error;return 200===i.status})),Ue=e=>qe(void 0,void 0,void 0,(function*(){Ke();let t={deviceId:He.deviceId,appId:He.appId};const{data:n,response:r}=yield le.delete("deregister-token",t,e);if(Be(Ue.name,n),r.error)throw r.error;return 200===r.status})),$e=e=>{if(!K(e))return null;const t=e.atomic;if(!K(t))return null;const n=t,{source:r,cardInstanceId:i,streamContainerId:s,detail:a}=n;return"io.atomic"!==r||"string"!=typeof i||"number"!=typeof s&&"string"!=typeof s?null:{cardInstanceId:i,containerId:s.toString(),detail:K(a)?a:{}}},Ve=e=>{const t=[];return e||t.push("deviceInfo should be a non-null object."),(null==e?void 0:e.platform)||t.push('platform should be either "iOS" or "Android".'),(null==e?void 0:e.deviceId)||t.push("deviceId should be a non-empty string."),(null==e?void 0:e.appId)||t.push("appId should be a non-empty string."),(null==e?void 0:e.platform)&&!["ios","android"].includes(e.platform.toLowerCase())&&t.push('platform is invalid: should be either "iOS" or "Android".'),t.length>0?{success:!1,errors:t}:{success:!0,errors:[]}},Ke=()=>{if(!Ve(He).success)throw new Error("You must call setNativeDeviceInfo before registering for native notifications")},Be=(e,t)=>{var n;(null==t?void 0:null===(n=t.errors)||void 0===n?void 0:n.length)&&i.error({level1:[`Errors detected with ${e}`,...t.errors.map(e=>null==e?void 0:e.title)]})};let ze;!function(e){e.cardCompleted="card-completed",e.cardDismissed="card-dismissed",e.cardSnoozed="card-snoozed",e.cardFeedUpdated="card-feed-updated",e.cardDisplayed="card-displayed",e.cardVotedUp="card-voted-up",e.cardVotedDown="card-voted-down",e.runtimeVarsUpdated="runtime-vars-updated",e.streamDisplayed="stream-displayed",e.userRedirected="user-redirected",e.snoozeOptionsDisplayed="snooze-options-displayed",e.snoozeOptionsCanceled="snooze-options-canceled",e.cardSubviewDisplayed="card-subview-displayed",e.cardSubviewExited="card-subview-exited",e.videoPlayed="video-played",e.videoCompleted="video-completed",e.sdkInitialized="sdk-initialized",e.requestFailed="request-failed",e.notificationReceived="notification-received"}(ze||(ze={}));const Qe=e=>(!e.eventName&&e.analyticsEvent&&(e.eventName=e.analyticsEvent),e),Ge=(e,t)=>{const n=e.eventPayload?Object.assign({},e.eventPayload):null;if(!n)return null;switch(e.type){case"snoozed":n.eventName=ze.cardSnoozed,n.analyticsEvent=ze.cardSnoozed;break;case"dismissed":n.eventName=ze.cardDismissed,n.analyticsEvent=ze.cardDismissed;break;case"submitted":n.eventName=ze.cardCompleted,n.analyticsEvent=ze.cardCompleted;break;default:return null}return n.sdkContext={containerId:t},n},Je=e=>{const t=(new Date).toISOString();return{id:(0,B.v4)(),analyticsEvent:ze.cardFeedUpdated,eventName:ze.cardFeedUpdated,endUserId:e.endUserId,timestamp:t,properties:{cardCount:e.cardCount},sdkContext:{containerId:e.streamContainerId},eventContext:{userLocalTimestamp:(0,W.format)(t,"YYYY-MM-DDTHH:mm:ss.SSSZ")}}};let Xe;!function(e){e.STATE="state-update",e.ANALYTICS_EVENT="analytics-event-dispatched"}(Xe||(Xe={}));var Ze=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const tt=n(5373),nt="atomic-sdk-launcher-wrapper",rt="atomic-sdk-launcher",it={callbackUnavailable:"authCallbackError",retryIntervalPending:"authRetryIntervalPending",tokenError:"authTokenError"},st=(e,t)=>{t(e)},at=(e,t)=>{var n,r,i,s,a;const o=(null===(n=t.features)||void 0===n?void 0:null===(r=n.cordova)||void 0===r?void 0:r.enabled)||!1,c=o?(()=>{const e=document.querySelector("script#atomic-frame-manager"),t=e?e.src:null;if(!t)return null;const n=new URL(t),r=n.protocol.toLowerCase();return("http:"===r||"https:"===r)&&"localhost"!==n.hostname?null:t})():"https://downloads.atomic.io/web-sdk/release/23.3.2/iframe-manager.js";if(o&&!c)return void console.error("The Atomic SDK could not locate a required script (iframe-manager.js). Ensure you have included the script on your page and have added the ID `atomic-frame-manager` to the element.");const u=null===(i=t.enabledUiElements)||void 0===i?void 0:null===(s=i.customContainerHeader)||void 0===s?void 0:s.headerElement;(null===(a=t.enabledUiElements)||void 0===a?void 0:a.customContainerHeader)&&(t.enabledUiElements.customContainerHeader.headerElement="");const l=`\n  <!doctype html>\n    <head>\n      <title>Atomic SDK</title>\n      <style>\n        html,body {margin: 0; height: 100%; width:100%; overflow: hidden;}\n        * {box-sizing: border-box;}\n      </style>\n    </head>\n    <body>\n      <script src='${c}' data-config='${JSON.stringify(t)}' type='application/javascript'><\/script>\n      <div id='custom-container-header' style='display:none;'>${null!=u?u:""}</div>\n    </body>\n  </html>\n`;e.setAttribute("srcdoc",l)};class ot{static setSessionDelegate(e,t){this.tokenRetryInterval=t||0,this.onAuthTokenRequested=e}static launch(e){ot.init(),e.onAuthTokenRequested&&console.error("SDK.launch: Deprecated auth configuration property supplied. From version 1.0.0 an auth callback which resolves to a promise that supplies an authentication token must be set using `AtomicSDK.setSessionDelegate`");const t=new ct(e,Object.assign(Object.assign({},this.internalConfig),{autosizeFrame:!1}),"launcher",this.analyticsQueue);return ot.streamContainers[t.instanceId]={sendMessageToIframe:e=>t.sendMessageToIframe(e),logout:()=>{t.sendMessageToIframe({action:u})}},t}static embed(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ot.init(),t.onAuthTokenRequested&&console.error("SDK.embed: Deprecated auth configuration property supplied. From version 1.0.0 an auth callback which resolves to a promise that supplies an authentication token must be set using `AtomicSDK.setSessionDelegate`");const r=new ct(t,Object.assign(Object.assign({},this.internalConfig),{autosizeFrame:n}),"standalone",this.analyticsQueue,e);return ot.streamContainers[r.instanceId]={sendMessageToIframe:e=>r.sendMessageToIframe(e),logout:()=>{r.sendMessageToIframe({action:u})}},r}static singleCard(e,t){ot.init(),t.onAuthTokenRequested&&console.error("SDK.singleCard: Deprecated auth configuration property supplied. From version 1.0.0 an auth callback which resolves to a promise that supplies an authentication token must be set using `AtomicSDK.setSessionDelegate`");const n=new ct(t,Object.assign(Object.assign({},this.internalConfig),{autosizeFrame:!0}),"single-card",this.analyticsQueue,e);return ot.streamContainers[n.instanceId]={sendMessageToIframe:e=>n.sendMessageToIframe(e),logout:()=>{n.sendMessageToIframe({action:u})}},n}static init(){return Ze(this,void 0,void 0,(function*(){if(!ot.hasPerformedInitialisation){const e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(tt)),document.head.appendChild(e),window.addEventListener("request-failed",e=>{const t=e.detail,n=this.analyticsQueue.enqueue({timestamp:new Date,endUserId:t.request.endUserId||"",containerId:t.request.streamContainerId,cardInstanceId:t.request.cardInstanceId,eventName:Ne.REQUEST_FAILED,properties:{path:t.request.path,statusCode:t.request.statusCode}});if(n){var r;xe.sendAnalyticsMessage([n]);const e=Qe(n);null===(r=ot.sdkEventObserver)||void 0===r||r.call(ot,e)}}),ot.hasPerformedInitialisation=!0}const e=Te.webSocketConnection;e&&(null==e?void 0:e.readyState)!==(null==e?void 0:e.CLOSED)||this.internalConfig.webSocketDisabled||(yield this.createWebSocketConnection().catch(e=>{i.debug({level3:[`SDK init, error creating WebSocket connection: ${e}`]})}))}))}static initialise(e,t,n){return Ze(this,void 0,void 0,(function*(){const r={webSocketDisabled:this.internalConfig.webSocketDisabled,pollingFallbackDisabled:this.internalConfig.pollingFallbackDisabled,testHost:this.internalConfig.testHost,clientAppVersion:this.internalConfig.clientAppVersion};this.internalConfig=Object.assign({apiHost:e,apiKey:t,environmentId:n},r),e&&t&&n&&sessionStorage.setItem(q,JSON.stringify({initialiseCalled:!0,eventDispatched:!1})),ot.cachedToken=void 0,le.initialise(e,t,n),this.internalConfig.webSocketDisabled||(Te.initialise(e,t,n),xe.reset(),yield this.createWebSocketConnection().catch(e=>{i.debug({level3:[`SDK initialise, error creating WebSocket connection: ${e}`]})}))}))}static setApiProtocol(e){const{apiHost:t,apiKey:n,environmentId:r}=this.internalConfig;if(t||n||r)throw new Error("You must set API protocol before initialising the SDK. This is because the SDK needs to know the protocol to use when creating a connection to the Atomic Platform.");this.internalConfig.webSocketDisabled="http"===e,this.webSocketDisabled="http"===e}static enableDebugMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i.logLevel=e}static createWebSocketConnection(){return Ze(this,arguments,void 0,(function*(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;const n={1:100,2:15e3,3:6e4};if(Te.openingConnection)return;const r={onMessage:e=>{xe.handleWebSocketMessage(e)},onError:e=>{i.error({level3:["WebSocket error handler received error message",e]})},onOpen:()=>Ze(this,void 0,void 0,(function*(){try{yield this.handleTokenRequest({skipCache:!0,authWebSocket:!0}),xe.lastPongSuccess=(new Date).toISOString()}catch(e){i.error({level1:["Error authenticating WebSocket."],level2:[e]}),Object.values(ot.streamContainers).forEach(t=>{var n;t.sendMessageToIframe({action:M,values:null!==(n=e.message)&&void 0!==n?n:e})})}})),onClose:r=>{switch(r.code){case Se.sdkChangingProtocol:case Se.sdkReinitialisedWebSocket:case Se.sdkSessionEnding:case Se.sdkCordovaBackgrounded:case Se.unitTestConnectionClose:i.debug({level1:[`WebSocket closed with ${r.code} connection close code`],level2:[r]});break;case Se.retryConnection:if(i.debug({level1:[`WebSocket closed with ${r.code} connection close code`],level2:[r]}),e<3){const t=e+1;setTimeout(()=>{this.createWebSocketConnection(t)},n[t])}else this.triggerPollingFallback(t);break;case Se.sdkClosedConnection:case Se.notPermitted:case Se.abnormalClosure:default:ot.internalConfig.pollingFallbackDisabled||this.triggerPollingFallback(t),i.debug({level1:[`WebSocket closed with ${r.code} connection close code`],level2:[r]})}}};try{Te.open("socket",r,t),xe.resubscribeActiveSubscriptions()}catch(e){i.error({level1:["Error creating WebSocket connection"],level2:[e]});const t=new Error(`Error creating WebSocket connection: ${e}`);throw t.name="WebSocket connection error",t}}))}static reinitialiseWebSocketConnection(){Te.close(Se.sdkReinitialisedWebSocket),this.createWebSocketConnection()}static authenticateWebSocketConnection(e){return Ze(this,void 0,void 0,(function*(){xe.sendAuthMessage(e),Te.connectionAuthenticated||(Te.authenticatingConnection=!0,yield new Promise((e,t)=>{const n=setTimeout(()=>{ot.authMessageReject("WebSocket authentication timed out")},Te.authenticationTimeout);ot.authMessageResolve=()=>{i.debug({level3:["WebSocket auth promise resolved."]}),e(),Te.purgeMessageQueue(),clearTimeout(n),Te.authenticatingConnection=!1},ot.authMessageReject=e=>{i.error({level3:["WebSocket auth promise rejected.",e]}),Object.values(ot.streamContainers).forEach(t=>{var n;t.sendMessageToIframe({action:M,values:null!==(n=e.message)&&void 0!==n?n:e})}),t(e),clearTimeout(n),Te.authenticatingConnection=!1}}))}))}static simulateWebSocketError(e){Te.close(),this.createWebSocketConnection(0,e)}static triggerPollingFallback(e){var t;ot.authMessageResolve=()=>null,ot.authMessageReject=()=>null,e&&(Te.close(),Te.clearTimeouts()),Object.values(this.streamContainers).forEach(e=>{e.sendMessageToIframe({action:C})});const n=this.analyticsQueue.enqueue({timestamp:new Date,eventName:Ne.REQUEST_FAILED,endUserId:null!==(t=X(ot.cachedToken))&&void 0!==t?t:"",properties:Object.assign({path:`${this.internalConfig.environmentId}/socket`},e?{source:"user-simulate"}:{})});if(n){var r;xe.sendAnalyticsMessage([n]);const e=Qe(n);null===(r=ot.sdkEventObserver)||void 0===r||r.call(ot,e)}}static setTestHostHeader(e){this.internalConfig.testHost=e,le.setTestHostHeader(e)}static setClientAppVersion(e){if(!("string"==typeof e))return i.error({level1:["Could not set client app version"],level2:[": Invalid value provided, must be a string."]});e.length>128&&i.warn({level1:["Client app version truncated"],level2:[": value provided was longer than 128 character maximum."]});const t=e.substring(0,128);le.setClientAppVersion(t),Te.setClientAppVersion(t),this.internalConfig.clientAppVersion=t}static setRetryTimer(){ot.tokenRetryInterval&&!ot.tokenRetryTimer&&(ot.tokenRetryTimer=setTimeout(()=>{ot.tokenRetryTimer=void 0},ot.tokenRetryInterval))}static handleTokenRequest(e){var t,n;return Ze(this,void 0,void 0,(function*(){var r;let s,a=new Error;if(!ot.onAuthTokenRequested)throw a.message="Could not resolve an auth token. `AtomicSDK.setSessionDelegate` must be used to set a callback resolving to a promise that supplies an authentication token.",a.name=it.callbackUnavailable,a;if(ot.tokenRetryTimer)throw a.message="Not ready to retry token request",a.name=it.retryIntervalPending,a;if(ot.cachedToken&&!(null==e?void 0:e.skipCache)){const e=_(ot.cachedToken),t=300;if(!$(e.exp-t))return ot.cachedToken;s=e}const o=yield Promise.race([new Promise(e=>{setTimeout(()=>{e(void 0)},5e3)}),null===(r=ot.onAuthTokenRequested)||void 0===r?void 0:r.call(ot)]);if(!o||0===o.length)throw a.message=ie,a.name=it.tokenError,ot.setRetryTimer(),a;if(!U(o))throw a.message=se,a.name=it.tokenError,ot.setRetryTimer(),a;if(s&&s.exp-s.iat<3600){const e=_(o);(null!==(t=s.atomic_sub)&&void 0!==t?t:s.sub)!==(null!==(n=e.atomic_sub)&&void 0!==n?n:e.sub)&&i.error({level1:["User ID has changed between authenticated requests without first calling `AtomicSDK.logout` be sure to call this when a user is logged out"]})}const c=X(o),u=JSON.parse(sessionStorage.getItem(q)||"{}");if(c&&u.initialiseCalled&&!u.eventDispatched){const e={endUserId:c,eventName:Ne.SDK_INITIALIZED,timestamp:new Date,properties:{}},t=ot.analyticsQueue.enqueue(e,"sdk-initialized");if(t){var l;xe.sendAnalyticsMessage([t]);const e=Qe(t);null===(l=ot.sdkEventObserver)||void 0===l||l.call(ot,e)}sessionStorage.setItem(q,JSON.stringify(Object.assign(Object.assign({},u),{eventDispatched:!0})))}if((null==e?void 0:e.authWebSocket)&&Te.isConnected()&&!Te.authenticatingConnection)try{yield ot.authenticateWebSocketConnection(o)}catch(a){throw i.error({level3:["Fresh auth token received, error authenticating WebSocket connection with new token.",a]}),a}return ot.cachedToken=o}))}static updateAuthToken(e){const t=new Error("As of version 1.0.0 this can no longer be called to update the auth token. Instead `AtomicSDK.logout` should be called to indicate the authenticated user has logged out and the callback set on `AtomicSDK.setSessionDelegate` should then supply the token for the newly authenticated user");console.error(t)}static getCurrentUserId(){var e;return null!==(e=X(ot.cachedToken))&&void 0!==e?e:""}static requestCardCount(e){return Ze(this,arguments,void 0,(function*(){if(arguments.length>1){const t=new Error("Function called with deprecated parameter, as of version 1.0.0 authTokenCallback is not required to be passed. Instead use `AtomicSDK.setSessionDelegate`, supplying a callback resolving to a promise that supplies an authentication token.");console.error(t);const n=arguments[0];e=arguments[1],ot.onAuthTokenRequested||ot.setSessionDelegate(n)}if(!e)throw new Error("A stream container ID is required when requesting card count.");if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to request card count.");try{const t=yield le.get(`feed/${e}`,{requestToken:yield ot.handleTokenRequest},void 0,{streamContainerId:e});if(t.response.error)throw t.response.error;if(200===t.response.status&&t.data&&t.data.cardInstances)return{totalCards:t.data.cardInstances.length};throw new Error("Unexpected response returned when fetching card count.")}catch(e){throw new Error(`Card count could not be retrieved. ${e.message}`)}}))}static sendEvent(e){return Ze(this,arguments,void 0,(function*(){var t,n,r;if(arguments.length>1){const t=new Error("Function called with deprecated parameter, as of version 1.0.0 authTokenCallback is not required to be passed. Instead use `AtomicSDK.setSessionDelegate`, supplying a callback resolving to a promise that supplies an authentication token.");console.error(t);const n=arguments[0];e=arguments[1],ot.onAuthTokenRequested||ot.setSessionDelegate(n)}if(!e.name)throw new Error("An event name is required to send an event.");if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to send an event.");let i={name:e.name,payload:{detail:(null===(t=e.payload)||void 0===t?void 0:t.detail)||{},metadata:(null===(n=e.payload)||void 0===n?void 0:n.metadata)||{},notificationDetail:(null===(r=e.payload)||void 0===r?void 0:r.notificationDetail)||{}}};e.lifecycleId&&(i.lifecycleId=e.lifecycleId);try{const e=yield le.post("event",{data:i},{requestToken:yield ot.handleTokenRequest});if(e.data&&e.data.errors){const t=e.data.errors.map(e=>e.title||"").join("\n");throw new Error(`The following errors were returned: ${t}`)}if(e.response.error)throw e.response.error;if(200!==e.response.status)throw new Error("No error information was available.");return e.data}catch(e){throw new Error(`The event could not be sent. ${e.message}`)}}))}static sendCustomEvent(e){return Ze(this,void 0,void 0,(function*(){var t;if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to send a custom event.");const n=X(yield ot.handleTokenRequest());if(!n)throw new Error("Could not send custom event, a valid user ID was not obtained from the auth token.");if("string"!=typeof e.eventName||!(null===(t=e.eventName)||void 0===t?void 0:t.length))throw new Error("Could not send custom event, an invalid event name was supplied. The `eventName` must be a string of non zero length.");if(void 0!==e.properties&&(Array.isArray(e.properties)||null===e.properties||"object"!=typeof e.properties))throw new Error("Could not send custom event, an invalid value was supplied for event properties.");const r=this.analyticsQueue.enqueue(Object.assign({endUserId:n,eventName:e.eventName,timestamp:new Date},e.properties?{properties:e.properties}:{}),"custom");r&&xe.sendAnalyticsMessage([r])}))}static observeSDKEvents(e){this.sdkEventObserver=e}static requestUserMetrics(){return Ze(this,arguments,void 0,(function*(){if(arguments.length>0){const e=new Error("Function called with deprecated parameter, as of version 1.0.0 authTokenCallback is not required to be passed. Instead use `AtomicSDK.setSessionDelegate`, supplying a callback resolving to a promise that supplies an authentication token.");console.error(e);const t=arguments[0];ot.onAuthTokenRequested||ot.setSessionDelegate(t)}if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to request user metrics.");try{const e=yield le.get("user-metrics",{requestToken:yield ot.handleTokenRequest},this.cachedUserMetrics.lastModified);if(e.response.error)throw e.response.error;switch(e.response.status){case 200:return this.cachedUserMetrics={lastModified:e.response.etag||void 0,userMetricsResponse:e.data,userMetrics:new Me(e.data)},this.cachedUserMetrics.userMetrics;case 304:if(this.cachedUserMetrics.userMetricsResponse)return new Me(this.cachedUserMetrics.userMetricsResponse);throw new Error("Response indicated that there were no new metrics, but no cached metrics could be returned.");default:throw new Error("No error information was available.")}}catch(e){throw new Error(`User metrics could not be retrieved. ${e.message}`)}}))}static updateUser(e){return Ze(this,void 0,void 0,(function*(){if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to update a user profile.");try{const{ok:t,error:n}=yield pe(e,{requestToken:yield ot.handleTokenRequest});if(n)throw n;return t}catch(e){throw new Error(`User update could not be completed. ${e.message}`)}}))}static logout(){return Ze(this,arguments,void 0,(function*(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e)try{yield ot.deregisterDeviceForNotifications()}catch(e){e.message.includes("You must call setNativeDeviceInfo before registering for native notifications")||console.error(`Problem de-registering notifications when logging out: ${e.message}`)}Object.values(ot.streamContainers).forEach(e=>{e.logout()}),ot.streamContainers={},yield this.analyticsQueue.flush(),ot.cachedUserMetrics={},ot.cachedToken=void 0,ot.tokenRetryTimer=void 0,ot.sdkEventObserver=null,sessionStorage.removeItem(H),Te.close(Se.sdkSessionEnding,"Connection closed by SDK, user logged out"),Te.reset(),ot.internalConfig=Object.assign(Object.assign({},ot.internalConfig),{apiHost:void 0,apiKey:void 0,environmentId:void 0}),le.reset()}))}static login(e,t,n,r,i){ot.initialise(e,t,n),ot.setSessionDelegate(r,i)}static setNativeDeviceInfo(e){try{return We(e)}catch(e){throw new Error(`Failed to setNativeDeviceInfo: ${e.message}`)}}static registerDeviceForNotifications(e){return Ze(this,void 0,void 0,(function*(){if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to register the device for push notifications");try{return yield _e(e,{requestToken:yield ot.handleTokenRequest})}catch(e){throw new Error(`${_e.name} could not be completed. ${e.message}`)}}))}static deregisterDeviceForNotifications(){return Ze(this,void 0,void 0,(function*(){if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to deregister the device for push notifications");try{return yield Ue({requestToken:yield ot.handleTokenRequest})}catch(e){throw new Error(`${Ue.name} could not be completed. ${e.message}`)}}))}static registerStreamContainersForNotifications(e,t){return Ze(this,void 0,void 0,(function*(){if(!le.isInitialised())throw new Error("You must call `AtomicSDK.initialise` before attempting to register stream containers for notifications");try{return yield je(e,{requestToken:yield ot.handleTokenRequest},t)}catch(e){throw new Error(`${je.name} could not be completed. ${e.message}`)}}))}static notificationFromPushPayload(e){return $e(e)}static trackPushNotificationReceived(e){var t;const n=$e(e);if(null==n)return!1;const r=null!==(t=X(ot.cachedToken))&&void 0!==t?t:"";let i={eventName:Ne.NOTIFICATION_RECEIVED,endUserId:r,containerId:n.containerId,cardInstanceId:n.cardInstanceId,timestamp:new Date};const s=ot.analyticsQueue.enqueue(i);if(s){var a;xe.sendAnalyticsMessage([s]);const e=Qe(s);null===(a=ot.sdkEventObserver)||void 0===a||a.call(ot,e)}return!0}}et(ot,"hasPerformedInitialisation",!1),et(ot,"webSocketDisabled",!1),et(ot,"cachedUserMetrics",{}),et(ot,"internalConfig",{}),et(ot,"cachedToken",void 0),et(ot,"onError",void 0),et(ot,"sdkEventObserver",null),et(ot,"userMetricsTriggerEvents",new Set([ze.cardFeedUpdated,ze.cardCompleted,ze.cardDismissed,ze.cardSnoozed,ze.streamDisplayed,ze.sdkInitialized])),et(ot,"onAuthTokenRequested",void 0),et(ot,"tokenRetryInterval",0),et(ot,"tokenRetryTimer",void 0),et(ot,"authMessageResolve",()=>null),et(ot,"authMessageReject",()=>null),et(ot,"streamContainers",{}),et(ot,"containersBroadcastChannel","BroadcastChannel"in window?new BroadcastChannel("stream-container-broadcast-channel"):void 0),et(ot,"analyticsQueue",new class{constructor(){Q(this,"eventQueue",[]),Q(this,"flushTimeout",null),Q(this,"flushPromise",null);const e=localStorage.getItem(Z);if(e)try{this.eventQueue=JSON.parse(e)}catch(e){}this.scheduleFlush()}createEventPayload(e,t){const n={id:(0,B.v4)(),endUserId:e.endUserId,timestamp:e.timestamp.toISOString(),properties:e.properties||{},eventContext:{userLocalTimestamp:(0,W.format)(e.timestamp,J)}};switch(t){case"standard":{const t=e;return Object.assign(Object.assign({},n),{analyticsEvent:t.eventName,hostContext:t.hostContext||{},sdkContext:{containerId:t.containerId||""},streamContext:{streamLength:t.streamLength||0,streamLengthVisible:t.streamLengthVisible||0,cardPositionInStream:t.streamCardPosition||0},cardContext:{cardInstanceId:t.cardInstanceId||"",cardInstanceStatus:t.cardInstanceStatus||"",cardViewState:t.cardViewState||"topview",cardPresentation:"individual"}})}case"custom":return Object.assign(Object.assign({},n),{eventType:"custom",eventName:e.eventName,sdkContext:{}});case"sdk-initialized":return Object.assign(Object.assign({},n),{analyticsEvent:e.eventName,hostContext:{},cardContext:{},streamContext:{},sdkContext:{}});default:return null}}enqueue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"standard";if(!le.isInitialised())return null;const n=this.createEventPayload(e,t);return n&&(this.eventQueue.push(n),this.eventQueue.length>500&&this.eventQueue.splice(0,this.eventQueue.length-500)),this.persistQueue(),n}removeProcessedEvents(e){this.eventQueue.length&&(this.eventQueue=this.eventQueue.filter(t=>!e.includes(t.id)),this.persistQueue())}performFlush(){return z(this,void 0,void 0,(function*(){if(null!=this.flushTimeout&&(window.clearTimeout(this.flushTimeout),this.flushTimeout=null),this.eventQueue.length&&le.isInitialised()){const e=[...this.eventQueue];200===(yield le.put("analytics",{data:e})).response.status&&(this.eventQueue=this.eventQueue.filter(t=>!e.includes(t)),this.persistQueue())}this.scheduleFlush()}))}flush(){return z(this,void 0,void 0,(function*(){return this.flushPromise=null===this.flushPromise?this.performFlush():this.flushPromise.then(()=>this.performFlush()),this.flushPromise}))}scheduleFlush(){this.flushTimeout=window.setTimeout(this.flush.bind(this),G)}persistQueue(){localStorage.setItem(Z,JSON.stringify(this.eventQueue))}});class ct{constructor(e,t,n,r,i){et(this,"iframe",void 0),et(this,"modalIframe",void 0),et(this,"toastIframe",void 0),et(this,"outsideClickListener",void 0),et(this,"queuedMessages",[]),et(this,"iframeLoaded",!1),et(this,"appOpen",!1),et(this,"launchButtonIconContainer",void 0),et(this,"launcher",void 0),et(this,"resolvedConfiguration",void 0),et(this,"instanceId",void 0),et(this,"streamFilters",new Le(()=>this.sendMessageToIframe({action:R,values:{filter:this.streamFilters.getFilterObject()}}),()=>{this.sendMessageToIframe({action:R,values:{filter:void 0}})})),et(this,"config",void 0),et(this,"analyticsQueue",void 0);const s=`${e.streamContainerId}`;if(null===e.streamContainerId||void 0===e.streamContainerId||"string"!=typeof e.streamContainerId&&"number"!=typeof e.streamContainerId||0===s.trim().length)throw new Error("The Atomic SDK failed to start. You must pass a `streamContainerId` when instantiating a stream container.");if(!ot.onAuthTokenRequested&&e.onAuthTokenRequested&&ot.setSessionDelegate(e.onAuthTokenRequested),!ot.onAuthTokenRequested)throw new Error("You must use `AtomicSDK.setSessionDelegate` to set a callback resolving to a promise that supplies an authentication token before attempting to create a stream container.");if(!this.iframeLoaded){var a,o;let c=Object.assign(Object.assign(Object.assign({},e),{streamContainerId:s}),t),u=c.cardListRefreshInterval;c.cardListRefreshInterval=null!=u?0==u?0:Math.max(1e3,u):void 0;let l=c.runtimeVariableResolutionTimeout;if(c.runtimeVariableResolutionTimeout=null!=l?Math.max(0,l):void 0,"single-card"!==n&&(null===(a=e.features)||void 0===a?void 0:null===(o=a.horizontalContainerConfig)||void 0===o?void 0:o.enabled)&&!e.features.horizontalContainerConfig.cardWidth)throw new Error("The card width must be specified in the `horizontalContainerConfig` configuration object when attempting to create a stream container in horizontal mode.");this.resolvedConfiguration=c,this.instanceId=(0,B.v4)(),this.analyticsQueue=r,this.initIframe(c,n,i)}}stop(){this.iframeLoaded=!1,this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.modalIframe&&this.modalIframe.parentNode&&this.modalIframe.parentNode.removeChild(this.modalIframe),this.toastIframe&&this.toastIframe.parentNode&&this.toastIframe.parentNode.removeChild(this.toastIframe),this.launcher&&this.launcher.parentNode&&this.launcher.parentNode.removeChild(this.launcher),xe.activeSubscriptions[this.instanceId]&&(xe.unsubscribeFromCardFeed([this.instanceId]),delete ot.streamContainers[this.instanceId])}updateVariables(){this.sendMessageToIframe({action:d})}setOpen(e){var t;if(void 0===e)return i.error({level1:["Open status not supplied to updateOpenStatus"]});if("launcher"===this.config.embedMode)document.removeEventListener("click",this.outsideClickListener);else if(!(null===(t=this.config.features)||void 0===t?void 0:t.controlledContainerOpenState))return i.error({level1:["To change the open status for this container you must enable `controlledContainerOpenState` in the features configuration"]});this.appOpen!==e&&(this.appOpen=e,this.updateAppOpen())}getIcon(e){var t;const{openIconSrc:n,closeIconSrc:r}=(null===(t=this.config.enabledUiElements)||void 0===t?void 0:t.launcherButton)||{};return n&&r?`<img src="${e?r:n}" style="max-height: 100%; max-width: 100%; margin: auto">`:e?'\n    <svg width="12" height="12" viewBox="0 0 12 12">\n      <path\n        d="M1 1L6 6L11 11M1 11L11 1"\n        stroke-width="2"\n        stroke-linecap="round"\n        stroke="white"\n        style="pointer-events: none;"\n      />\n    </svg>\n  ':'\n    <svg\n      xmlns="http://www.w3.org/2000/svg"\n      width="20"\n      height="32"\n      viewBox="0 0 28 32"\n      fill="none"\n      style="pointer-events: none;"\n    >\n      <path\n        d="M18 22.8V26C18 28.2091 16.2091 30 14 30C11.7909 30 10 28.2091 10 26V22.8M18 22.8H10M18 22.8H26L22.8 19.6V17.2M10 22.8H2L5.2 19.6C5.2 19.6 5.2 15.5998 5.2 10.7998C5.2 5.9998 9.2 2 14 2C15.433 2 16.7947 2.3565 18 2.98436M11.6 11.6L15.6 15.6L26 5.2"\n        stroke="white"\n        stroke-width="3"\n        stroke-linecap="round"\n        stroke-linejoin="round"\n      />\n    </svg>\n  '}toggleAppOpen(){this.appOpen=!this.appOpen,this.updateAppOpen()}updateAppOpen(){const e={action:"updateAppOpen",values:{open:this.appOpen}};this.sendMessageToIframe(e)}initLauncherButton(){var e;const{disabled:t,backgroundColor:n}=(null===(e=this.config.enabledUiElements)||void 0===e?void 0:e.launcherButton)||{};if(t)return;const r=document.createElement("div"),i=document.createElement("button");i.tabIndex=0,r.className=nt,i.className=rt,this.launchButtonIconContainer=i,this.launcher=r,i.style.backgroundColor=n||"",i.innerHTML=this.getIcon(!1),r.appendChild(i),document.body.appendChild(r),r.addEventListener("click",()=>{this.toggleAppOpen()}),this.outsideClickListener=e=>{e.target&&this.launcher&&this.launcher.contains(e.target)||this.toggleAppOpen()}}initIframe(e,t,n){var r,s,a,o;const c=Object.assign(Object.assign({},e),{windowOrigin:this.getWindowOrigin(),embedMode:t});this.config=c,this.iframe=document.createElement("iframe"),this.iframe.classList.add("atomic-sdk-frame"),this.iframe.classList.add(c.embedMode),this.iframe.setAttribute("frameBorder","0"),this.iframe.setAttribute("title",(null===(r=e.customStrings)||void 0===r?void 0:r.cardListTitle)||"Cards"),c.logLevel=i.logLevel,n?n.appendChild(this.iframe):document.body.appendChild(this.iframe),this.iframe.addEventListener("load",()=>{this.iframeLoaded=!0,this.flushMessages()}),at(this.iframe,c),"single-card"===t&&(null===(s=e.enabledUiElements)||void 0===s?void 0:s.cardListToast)&&(this.toastIframe=document.createElement("iframe"),this.toastIframe.classList.add("atomic-sdk-frame"),this.toastIframe.classList.add("toast-container"),this.toastIframe.setAttribute("id","atomic-sdk-toast-container"),this.toastIframe.setAttribute("frameBorder","0"),this.toastIframe.setAttribute("title","Toast messages"),this.toastIframe.setAttribute("role","presentation"),this.toastIframe.setAttribute("aria-hidden","true"),n?n.appendChild(this.toastIframe):document.body.appendChild(this.toastIframe),at(this.toastIframe,Object.assign(Object.assign({},c),{embedMode:"toast"}))),("single-card"===t||"standalone"===t&&(null===(a=e.features)||void 0===a?void 0:null===(o=a.horizontalContainerConfig)||void 0===o?void 0:o.enabled))&&(this.modalIframe=document.createElement("iframe"),this.modalIframe.classList.add("atomic-sdk-frame"),this.modalIframe.classList.add("modal-subview"),this.modalIframe.setAttribute("frameBorder","0"),this.modalIframe.setAttribute("role","presentation"),this.modalIframe.setAttribute("aria-hidden","true"),this.modalIframe.setAttribute("title","Empty Modal"),n?n.appendChild(this.modalIframe):document.body.appendChild(this.modalIframe),at(this.modalIframe,Object.assign(Object.assign({},c),{embedMode:"modal-subview"}))),window.addEventListener("message",this.onMessageReceived.bind(this))}onMessageReceived(e){var t;return Ze(this,void 0,void 0,(function*(){if(e.source===this.iframe.contentWindow||this.modalIframe&&e.source===this.modalIframe.contentWindow)switch(e.data.action){case o:{var n;this.config.onCardCountChanged&&this.config.onCardCountChanged(e.data.cardCount,e.data.totalCards);const t=Je({cardCount:e.data.cardCount,streamContainerId:this.resolvedConfiguration.streamContainerId||"",endUserId:ot.getCurrentUserId()});null===(n=ot.sdkEventObserver)||void 0===n||n.call(ot,t);break}case c:switch(this.config.embedMode){case"standalone":case"single-card":var r;this.appOpen=null===(r=this.config.features)||void 0===r?!0:!r.controlledContainerOpenState,this.updateAppOpen();break;case"launcher":this.iframe.tabIndex=-1,this.initLauncherButton()}break;case l:this.handleRuntimeVariableResolution(e.data.requestId,e.data.cards,this.config.onRuntimeVariablesRequested||st);break;case h:this.config.onLinkButtonPressed&&this.config.onLinkButtonPressed(e.data.payload);break;case f:this.config.onSubmitButtonPressed&&this.config.onSubmitButtonPressed(e.data.payload);break;case v:var s,a;if(this.appOpen=e.data.values.open,"launcher"===this.config.embedMode)this.updateVisibilityForLauncher(),null===(s=(a=this.resolvedConfiguration).onLauncherToggled)||void 0===s||s.call(a,this.appOpen);break;case m:this.config.onSizeChanged&&this.config.onSizeChanged(this.iframe.clientWidth,e.data.height);break;case p:if(e.data.sdkOnlyEvent){var u;const t=this.analyticsQueue.createEventPayload(e.data.event,"standard");t&&(null===(u=ot.sdkEventObserver)||void 0===u||u.call(ot,Qe(t)))}else this.enqueueAnalyticsEvent(e.data.event);break;case b:{this.config.onCardEvent&&this.config.onCardEvent(e.data.event);const t=Ge(e.data.event,e.data.streamContainerId);var d;if(t)ot.cachedUserMetrics={},null===(d=ot.sdkEventObserver)||void 0===d||d.call(ot,t);break}case g:ot.onError&&ot.onError(e.data.error);break;case y:if(e.data.requestId&&ot.onAuthTokenRequested){let t;try{t=yield ot.handleTokenRequest(),this.sendMessageToIframe({action:I,values:{requestId:e.data.requestId,authToken:t}},e.source)}catch(t){i.error({level3:["stream container requested auth token, error retrieving token",t]}),this.sendMessageToIframe({action:k,values:{requestId:e.data.requestId,error:t.message}})}}else console.error("The Atomic SDK requested an authentication token but no authentication callback has been set using `AtomicSDK.setSessionDelegate`. Use this method to set a callback resolving to a promise that supplies an authentication token");break;case S:try{Te.connectionAuthenticated||(yield ot.handleTokenRequest({skipCache:!0,authWebSocket:!0})),xe.subscribeToCardFeed([{subscriptionId:this.instanceId,streamContainerId:e.data.streamContainerId,filters:this.streamFilters.getFilterObject()}]),this.sendMessageToIframe({action:O,values:{subscriptionId:this.instanceId}})}catch(e){this.sendMessageToIframe({action:N,values:null!==(t=e.message)&&void 0!==t?t:e}),i.error({level1:["error sending card feed subscription request by WebSockets"],level2:[e]})}break;case w:Te.close(Se.sdkClosedConnection,"Subscription retry exceeded"),ot.authMessageResolve=()=>null,ot.authMessageReject=()=>null;break;case T:e.data.subscriptionId===this.instanceId&&(xe.unsubscribeFromCardFeed([this.instanceId]),delete ot.streamContainers[this.instanceId]);break;case D:ot.createWebSocketConnection().catch(e=>{var t;this.sendMessageToIframe({action:M,values:null!==(t=e.message)&&void 0!==t?t:e})});break;case x:Te.connectionHealthCheck()}}))}enqueueAnalyticsEvent(e){const t=this.analyticsQueue.enqueue(e);if(t){var n;xe.sendAnalyticsMessage([t]);const e=Qe(t);null===(n=ot.sdkEventObserver)||void 0===n||n.call(ot,e)}ot.containersBroadcastChannel?ot.containersBroadcastChannel.postMessage({type:Xe.ANALYTICS_EVENT,eventQueued:e}):i.error({level1:["BroadcastChannel API unavailable"]})}updateVisibilityForLauncher(){var e;this.appOpen?(this.iframe.className+=" open",this.iframe.tabIndex=0,this.iframe.focus(),document.addEventListener("click",this.outsideClickListener)):(this.iframe.className=this.iframe.className.replace(" open",""),this.iframe.tabIndex=-1,null===(e=this.launchButtonIconContainer)||void 0===e||e.focus(),document.removeEventListener("click",this.outsideClickListener));this.launchButtonIconContainer&&(this.launchButtonIconContainer.innerHTML=this.getIcon(this.appOpen))}handleRuntimeVariableResolution(e,t,n){n(t.map(e=>Object.assign(Object.assign({},e),{runtimeVariables:new Map(e.runtimeVariables)})),n=>{let r=t;if(Array.isArray(n))if(n.length!==t.length)console.error(`The number of cards returned from the runtime variable resolver (${n.length}) is not equal to the cards provided (${t.length}).`);else{n.every(e=>{if(!(e.runtimeVariables instanceof Map))return!1;for(const t of e.runtimeVariables)if("string"!=typeof t[0]||"string"!=typeof t[1])return!1;return!0})?r=n:console.error("One or more runtime variables have been resolved to non-string types. Runtime variables can only be resolved to strings currently.")}else console.error("Incorrect type returned when resolving runtime variables - an array of cards was expected.");const i={action:"didResolveRuntimeVariables",values:{cards:r.map(e=>Object.assign(Object.assign({},e),{runtimeVariables:Array.from(e.runtimeVariables.entries())})),requestId:e}};this.sendMessageToIframe(i)})}sendMessageToIframe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.iframe.contentWindow;t&&(this.iframeLoaded?t.postMessage(e,this.getWindowOrigin()):this.queuedMessages.push(e))}flushMessages(){const e=this.iframe.contentWindow;e&&(this.queuedMessages.forEach(t=>e.postMessage(t,this.getWindowOrigin())),this.queuedMessages=[])}getWindowOrigin(){var e,t;return(null===(e=this.resolvedConfiguration.features)||void 0===e?void 0:null===(t=e.cordova)||void 0===t?void 0:t.enabled)?"*":`${window.location.protocol}//${window.location.host}`}}})(),r=r.default})()}));